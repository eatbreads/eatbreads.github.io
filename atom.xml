<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>æ¬¢è¿æ¥åˆ°å°é¢åŒ…çš„å°ç«™ğŸ¥</title>
  
  
  <link href="https://eatbreads.github.io/atom.xml" rel="self"/>
  
  <link href="https://eatbreads.github.io/"/>
  <updated>2025-05-03T15:03:00.322Z</updated>
  <id>https://eatbreads.github.io/</id>
  
  <author>
    <name>å°é¢åŒ…ğŸ¥</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>NginxåŸºç¡€é…ç½®ä¸ä½¿ç”¨æŒ‡å—</title>
    <link href="https://eatbreads.github.io/posts/8a38e9a9.html"/>
    <id>https://eatbreads.github.io/posts/8a38e9a9.html</id>
    <published>2025-05-03T14:59:43.000Z</published>
    <updated>2025-05-03T15:03:00.322Z</updated>
    
    <content type="html"><![CDATA[<h3 id="è™½ç„¶æ˜¯å¾ˆä¹…ä»¥å‰åšçš„äº†-ä½†æ˜¯è¿˜æ˜¯è®°å½•ä¸€ä¸‹å§-å› ä¸ºäº”ä¸€æ²¡å­¦ä¹ æ²¡ä¸œè¥¿æ›´æ–°åšå®¢äº†-å˜»å˜»">è™½ç„¶æ˜¯å¾ˆä¹…ä»¥å‰åšçš„äº†,ä½†æ˜¯è¿˜æ˜¯è®°å½•ä¸€ä¸‹å§,å› ä¸ºäº”ä¸€æ²¡å­¦ä¹ æ²¡ä¸œè¥¿æ›´æ–°åšå®¢äº†(å˜»å˜»)</h3><h1>NginxåŸºç¡€é…ç½®ä¸ä½¿ç”¨æŒ‡å—</h1><h2 id="Nginxç®€ä»‹">Nginxç®€ä»‹</h2><p>Nginxæ˜¯ä¸€æ¬¾è½»é‡çº§çš„WebæœåŠ¡å™¨å’Œåå‘ä»£ç†æœåŠ¡å™¨ï¼Œä»¥å…¶é«˜æ€§èƒ½ã€ç¨³å®šæ€§å’Œä½èµ„æºæ¶ˆè€—è€Œé—»åã€‚å®ƒå¯ä»¥ä½œä¸ºHTTPæœåŠ¡å™¨ï¼Œä¹Ÿå¯ä»¥ä½œä¸ºåå‘ä»£ç†æœåŠ¡å™¨ï¼Œæ”¯æŒè´Ÿè½½å‡è¡¡ç­‰é«˜çº§åŠŸèƒ½ã€‚</p><h2 id="åŸºæœ¬å‘½ä»¤">åŸºæœ¬å‘½ä»¤</h2><h3 id="1-æœåŠ¡ç®¡ç†">1. æœåŠ¡ç®¡ç†</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å¯åŠ¨æœåŠ¡</span></span><br><span class="line">/usr/local/nginx/sbin/nginx -c /usr/local/nginx/conf/nginx.conf</span><br><span class="line"></span><br><span class="line"><span class="comment"># å…³é—­æœåŠ¡</span></span><br><span class="line">/usr/local/nginx/sbin/nginx -s stop</span><br><span class="line"></span><br><span class="line"><span class="comment"># é‡å¯æœåŠ¡</span></span><br><span class="line">/usr/local/nginx/sbin/nginx -s reload</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä¼˜é›…é€€å‡º</span></span><br><span class="line">/usr/local/nginx/sbin/nginx -s quit</span><br></pre></td></tr></table></figure><h3 id="2-é…ç½®æ–‡ä»¶ç®¡ç†">2. é…ç½®æ–‡ä»¶ç®¡ç†</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ç¼–è¾‘ä¸»é…ç½®æ–‡ä»¶</span></span><br><span class="line">vim /usr/local/nginx/conf/nginx.conf</span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥çœ‹é”™è¯¯æ—¥å¿—</span></span><br><span class="line"><span class="built_in">tail</span> -f /usr/local/nginx/logs/error.log</span><br></pre></td></tr></table></figure><h2 id="é…ç½®è¯¦è§£">é…ç½®è¯¦è§£</h2><h3 id="1-åŸºç¡€é…ç½®ç»“æ„">1. åŸºç¡€é…ç½®ç»“æ„</h3><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ä¸»é…ç½®æ–‡ä»¶</span></span><br><span class="line"><span class="section">http</span> &#123;</span><br><span class="line">    <span class="attribute">include</span> mime.types;</span><br><span class="line">    <span class="attribute">default_type</span> application/octet-stream;</span><br><span class="line"></span><br><span class="line">    <span class="comment"># åŒ…å«å…¶ä»–é…ç½®æ–‡ä»¶</span></span><br><span class="line">    <span class="attribute">include</span> /usr/local/nginx/conf/conf.d/<span class="regexp">*.conf</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="2-ç«™ç‚¹é…ç½®ç¤ºä¾‹">2. ç«™ç‚¹é…ç½®ç¤ºä¾‹</h3><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">server</span> &#123;</span><br><span class="line">    <span class="attribute">listen</span> <span class="number">80</span>;</span><br><span class="line">    <span class="attribute">server_name</span> example.com;</span><br><span class="line"></span><br><span class="line">    <span class="comment"># ç½‘ç«™æ ¹ç›®å½•</span></span><br><span class="line">    <span class="attribute">root</span> /var/www/html;</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># é»˜è®¤é¦–é¡µ</span></span><br><span class="line">    <span class="attribute">index</span> index.html index.htm;</span><br><span class="line"></span><br><span class="line">    <span class="comment"># è·¯å¾„é…ç½®</span></span><br><span class="line">    <span class="section">location</span> /admin &#123;</span><br><span class="line">        <span class="attribute">root</span> /var/www/admin;</span><br><span class="line">        <span class="attribute">index</span> index.html;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="3-åå‘ä»£ç†é…ç½®">3. åå‘ä»£ç†é…ç½®</h3><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">location</span> /api &#123;</span><br><span class="line">    <span class="attribute">proxy_pass</span> http://backend-server;</span><br><span class="line">    <span class="attribute">proxy_set_header</span> Host <span class="variable">$host</span>;</span><br><span class="line">    <span class="attribute">proxy_set_header</span> X-Real-IP <span class="variable">$remote_addr</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="å¸¸è§æ“ä½œæµç¨‹">å¸¸è§æ“ä½œæµç¨‹</h2><h3 id="1-æ·»åŠ æ–°ç«™ç‚¹">1. æ·»åŠ æ–°ç«™ç‚¹</h3><ol><li>åˆ›å»ºé…ç½®æ–‡ä»¶</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim /usr/local/nginx/conf/conf.d/mysite.conf</span><br></pre></td></tr></table></figure><ol start="2"><li>ç¼–å†™é…ç½®å†…å®¹</li></ol><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">server</span> &#123;</span><br><span class="line">    <span class="attribute">listen</span> <span class="number">80</span>;</span><br><span class="line">    <span class="attribute">server_name</span> mysite.com;</span><br><span class="line">    <span class="attribute">root</span> /var/www/mysite;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="3"><li>é‡æ–°åŠ è½½é…ç½®</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/usr/local/nginx/sbin/nginx -s reload</span><br></pre></td></tr></table></figure><h3 id="2-æ•…éšœæ’æŸ¥">2. æ•…éšœæ’æŸ¥</h3><ol><li>æ£€æŸ¥é…ç½®è¯­æ³•</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/usr/local/nginx/sbin/nginx -t</span><br></pre></td></tr></table></figure><ol start="2"><li>æŸ¥çœ‹é”™è¯¯æ—¥å¿—</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">tail</span> -f /usr/local/nginx/logs/error.log</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">è®°å½•Nginxçš„åŸºæœ¬ä½¿ç”¨æ–¹æ³•ï¼ŒåŒ…æ‹¬æœåŠ¡ç®¡ç†ã€é…ç½®ä¿®æ”¹å’Œåå‘ä»£ç†è®¾ç½®</summary>
    
    
    
    <category term="è¿ç»´ç¬”è®°" scheme="https://eatbreads.github.io/categories/%E8%BF%90%E7%BB%B4%E7%AC%94%E8%AE%B0/"/>
    
    
    <category term="æœåŠ¡å™¨" scheme="https://eatbreads.github.io/tags/%E6%9C%8D%E5%8A%A1%E5%99%A8/"/>
    
    <category term="è¿ç»´" scheme="https://eatbreads.github.io/tags/%E8%BF%90%E7%BB%B4/"/>
    
    <category term="Nginx" scheme="https://eatbreads.github.io/tags/Nginx/"/>
    
  </entry>
  
  <entry>
    <title>åŒºå—é“¾é’±åŒ…åœ°å€ç”ŸæˆåŸç†</title>
    <link href="https://eatbreads.github.io/posts/fcfcdc9e.html"/>
    <id>https://eatbreads.github.io/posts/fcfcdc9e.html</id>
    <published>2025-05-02T13:22:27.000Z</published>
    <updated>2025-05-02T13:25:52.995Z</updated>
    
    <content type="html"><![CDATA[<h1>åŒºå—é“¾é’±åŒ…åœ°å€ç”ŸæˆåŸç†</h1><h2 id="åœ°å€ç”Ÿæˆæµç¨‹å›¾">åœ°å€ç”Ÿæˆæµç¨‹å›¾</h2><p><img src="https://cdn-a.markji.com/files/6814c7319209d5011496b4fd_hd.png?e=1746194770056&amp;token=xX63b9jqTlDOcGmctt5K9254rV0LG8hS9BmDeFBy:P1YSyOXLmo8LmVfo4AY8uqr87AA=" alt="é’±åŒ…åœ°å€ç”Ÿæˆæµç¨‹"></p><h2 id="å®ç°æ­¥éª¤">å®ç°æ­¥éª¤</h2><h3 id="1-ç”Ÿæˆéšæœºæ•°">1. ç”Ÿæˆéšæœºæ•°</h3><p>é¦–å…ˆéœ€è¦ç”Ÿæˆä¸€ä¸ªé«˜è´¨é‡çš„éšæœºæ•°ä½œä¸ºç§å­ï¼š</p><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">use</span> rand::OsRng;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä½¿ç”¨æ“ä½œç³»ç»Ÿçº§åˆ«çš„éšæœºæ•°ç”Ÿæˆå™¨</span></span><br><span class="line"><span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">rand</span> = rand::OsRng::<span class="title function_ invoke__">new</span>().<span class="title function_ invoke__">unwrap</span>();</span><br></pre></td></tr></table></figure><p>è¿™é‡Œä½¿ç”¨äº†æ“ä½œç³»ç»Ÿæä¾›çš„éšæœºæ•°ç”Ÿæˆå™¨ï¼Œå¯ä»¥ä¿è¯éšæœºæ•°çš„å®‰å…¨æ€§å’Œéšæœºæ€§ã€‚</p><h3 id="2-ç”Ÿæˆå¯†é’¥å¯¹">2. ç”Ÿæˆå¯†é’¥å¯¹</h3><p>ä½¿ç”¨Ed25519æ¤­åœ†æ›²çº¿ç®—æ³•ç”Ÿæˆå…¬ç§é’¥å¯¹ï¼š</p><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">use</span> ed25519_dalek::&#123;Keypair, PublicKey, SecretKey&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç”Ÿæˆå¯†é’¥å¯¹</span></span><br><span class="line"><span class="keyword">let</span> (secret_key, public_key) = ed25519::<span class="title function_ invoke__">keypair</span>(&amp;key);</span><br></pre></td></tr></table></figure><p>Ed25519æ˜¯ä¸€ç§é«˜æ•ˆå®‰å…¨çš„æ¤­åœ†æ›²çº¿ç®—æ³•ï¼Œå¹¿æ³›åº”ç”¨äºåŒºå—é“¾å’ŒåŠ å¯†è´§å¸é¢†åŸŸã€‚</p><h3 id="3-å…¬é’¥å“ˆå¸ŒåŒ–">3. å…¬é’¥å“ˆå¸ŒåŒ–</h3><p>å¯¹å…¬é’¥è¿›è¡ŒSHA256å“ˆå¸Œè¿ç®—ï¼š</p><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">use</span> sha2::&#123;Sha256, Digest&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// åˆ›å»ºSHA256å“ˆå¸Œå™¨</span></span><br><span class="line"><span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">hasher1</span> = Sha256::<span class="title function_ invoke__">new</span>();</span><br><span class="line"><span class="comment">// è¾“å…¥å…¬é’¥æ•°æ®</span></span><br><span class="line">hasher1.<span class="title function_ invoke__">input</span>(pubKey);</span><br><span class="line"><span class="comment">// è·å–å“ˆå¸Œç»“æœ</span></span><br><span class="line">hasher1.<span class="title function_ invoke__">result</span>(pubKey);</span><br></pre></td></tr></table></figure><p>å“ˆå¸ŒåŒ–å¯ä»¥ï¼š</p><ul><li>ç¼©çŸ­åœ°å€é•¿åº¦</li><li>æé«˜å®‰å…¨æ€§</li><li>å¢åŠ åœ°å€çš„å”¯ä¸€æ€§</li></ul><h3 id="4-Base58ç¼–ç ">4. Base58ç¼–ç </h3><p>å°†å“ˆå¸Œåçš„å…¬é’¥è½¬æ¢ä¸ºäººç±»å¯è¯»çš„æ ¼å¼ï¼š</p><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// åˆ›å»ºåœ°å€ç»“æ„</span></span><br><span class="line"><span class="keyword">let</span> <span class="variable">address</span> = Address &#123;</span><br><span class="line">    body: pub_hash,</span><br><span class="line">    scheme: Scheme::Base58, <span class="comment">// ä½¿ç”¨Base58ç¼–ç </span></span><br><span class="line">    hash_type: HashType::Script,</span><br><span class="line">    ..<span class="built_in">Default</span>::<span class="title function_ invoke__">default</span>()</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// è¿›è¡Œç¼–ç </span></span><br><span class="line"><span class="keyword">let</span> <span class="variable">readable_address</span> = address.<span class="title function_ invoke__">encode</span>().<span class="title function_ invoke__">unwrap</span>();</span><br></pre></td></tr></table></figure><p>Base58ç¼–ç çš„ç‰¹ç‚¹ï¼š</p><ul><li>é¿å…ä½¿ç”¨å®¹æ˜“æ··æ·†çš„å­—ç¬¦</li><li>ä¿æŒè¾ƒé«˜çš„ä¿¡æ¯å¯†åº¦</li><li>ä¾¿äºäººå·¥è¯†åˆ«å’Œè¾“å…¥</li></ul><h2 id="å®‰å…¨è€ƒè™‘">å®‰å…¨è€ƒè™‘</h2><ol><li><p><strong>éšæœºæ•°ç”Ÿæˆ</strong></p><ul><li>ä½¿ç”¨å¯†ç å­¦å®‰å…¨çš„éšæœºæ•°ç”Ÿæˆå™¨</li><li>é¿å…ä½¿ç”¨ä¼ªéšæœºæ•°</li><li>ç¡®ä¿ç†µå€¼å……è¶³</li></ul></li><li><p><strong>ç§é’¥ä¿æŠ¤</strong></p><ul><li>æ°¸è¿œä¸åœ¨ç½‘ç»œä¼ è¾“ç§é’¥</li><li>ä½¿ç”¨å®‰å…¨çš„å­˜å‚¨æ–¹å¼</li><li>è€ƒè™‘å¤šé‡ç­¾åæœºåˆ¶</li></ul></li><li><p><strong>åœ°å€æ ¡éªŒ</strong></p><ul><li>æ·»åŠ æ ¡éªŒå’Œ</li><li>éªŒè¯åœ°å€æ ¼å¼</li><li>é˜²æ­¢è¾“å…¥é”™è¯¯</li></ul></li></ol><h2 id="æœ€ä½³å®è·µ">æœ€ä½³å®è·µ</h2><ol><li><strong>å¯†é’¥ç®¡ç†</strong></li></ol><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å®‰å…¨å­˜å‚¨ç§é’¥</span></span><br><span class="line"><span class="keyword">let</span> <span class="variable">encrypted_key</span> = <span class="title function_ invoke__">encrypt_key</span>(&amp;secret_key, password);</span><br><span class="line"><span class="title function_ invoke__">save_to_keystore</span>(&amp;encrypted_key);</span><br></pre></td></tr></table></figure><ol start="2"><li><strong>åœ°å€éªŒè¯</strong></li></ol><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// éªŒè¯åœ°å€æœ‰æ•ˆæ€§</span></span><br><span class="line"><span class="keyword">if</span> !address.<span class="title function_ invoke__">is_valid</span>() &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_ invoke__">Err</span>(<span class="string">&quot;Invalid address format&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="3"><li><strong>é”™è¯¯å¤„ç†</strong></li></ol><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å®Œå–„çš„é”™è¯¯å¤„ç†</span></span><br><span class="line"><span class="keyword">let</span> <span class="variable">address</span> = <span class="keyword">match</span> Address::<span class="title function_ invoke__">new</span>(pub_hash) &#123;</span><br><span class="line">    <span class="title function_ invoke__">Ok</span>(addr) =&gt; addr,</span><br><span class="line">    <span class="title function_ invoke__">Err</span>(e) =&gt; <span class="title function_ invoke__">handle_error</span>(e),</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">è¯¦ç»†ä»‹ç»åŒºå—é“¾é’±åŒ…åœ°å€çš„ç”Ÿæˆè¿‡ç¨‹ï¼ŒåŒ…æ‹¬éšæœºæ•°ç”Ÿæˆã€å¯†é’¥å¯¹åˆ›å»ºå’Œåœ°å€ç¼–ç </summary>
    
    
    
    <category term="åŒºå—é“¾å¼€å‘" scheme="https://eatbreads.github.io/categories/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%BC%80%E5%8F%91/"/>
    
    
    <category term="åŒºå—é“¾" scheme="https://eatbreads.github.io/tags/%E5%8C%BA%E5%9D%97%E9%93%BE/"/>
    
    <category term="Rust" scheme="https://eatbreads.github.io/tags/Rust/"/>
    
    <category term="åŠ å¯†ç®—æ³•" scheme="https://eatbreads.github.io/tags/%E5%8A%A0%E5%AF%86%E7%AE%97%E6%B3%95/"/>
    
  </entry>
  
  <entry>
    <title>åŒºå—é“¾ç½‘ç»œé€šä¿¡æµç¨‹è¯¦è§£</title>
    <link href="https://eatbreads.github.io/posts/a56f3323.html"/>
    <id>https://eatbreads.github.io/posts/a56f3323.html</id>
    <published>2025-05-01T13:02:30.000Z</published>
    <updated>2025-05-01T13:06:32.072Z</updated>
    
    <content type="html"><![CDATA[<h1 id="åŒºå—é“¾ç½‘ç»œé€šä¿¡æµç¨‹è¯¦è§£"><a href="#åŒºå—é“¾ç½‘ç»œé€šä¿¡æµç¨‹è¯¦è§£" class="headerlink" title="åŒºå—é“¾ç½‘ç»œé€šä¿¡æµç¨‹è¯¦è§£"></a>åŒºå—é“¾ç½‘ç»œé€šä¿¡æµç¨‹è¯¦è§£</h1><h2 id="ç½‘ç»œé€šä¿¡æµç¨‹å›¾"><a href="#ç½‘ç»œé€šä¿¡æµç¨‹å›¾" class="headerlink" title="ç½‘ç»œé€šä¿¡æµç¨‹å›¾"></a>ç½‘ç»œé€šä¿¡æµç¨‹å›¾</h2><p><img src="https://cdn-a.markji.com/files/681371c72d056573630e9f46_hd.png?e=1746107367582&amp;token=xX63b9jqTlDOcGmctt5K9254rV0LG8hS9BmDeFBy:_6gQHn20mgVSAAOWAXrxm_fAnf4=" alt="åŒºå—é“¾ç½‘ç»œé€šä¿¡æµç¨‹"></p><h2 id="æ¥æ”¶æ–¹æµç¨‹"><a href="#æ¥æ”¶æ–¹æµç¨‹" class="headerlink" title="æ¥æ”¶æ–¹æµç¨‹"></a>æ¥æ”¶æ–¹æµç¨‹</h2><h3 id="1-å¯åŠ¨æœåŠ¡"><a href="#1-å¯åŠ¨æœåŠ¡" class="headerlink" title="1. å¯åŠ¨æœåŠ¡"></a>1. å¯åŠ¨æœåŠ¡</h3><ul><li>è°ƒç”¨ <code>startServer</code></li><li>å¼€å§‹ç›‘å¬ç½‘ç»œè¿æ¥</li><li>å‡†å¤‡æ¥æ”¶å…¶ä»–èŠ‚ç‚¹çš„è¯·æ±‚</li></ul><h3 id="2-ç‰ˆæœ¬å¤„ç†-handleVersion"><a href="#2-ç‰ˆæœ¬å¤„ç†-handleVersion" class="headerlink" title="2. ç‰ˆæœ¬å¤„ç† (handleVersion)"></a>2. ç‰ˆæœ¬å¤„ç† (handleVersion)</h3><ul><li>æ¥æ”¶ç‰ˆæœ¬ä¿¡æ¯</li><li>æ¯”è¾ƒåŒºå—é«˜åº¦<ul><li>å¦‚æœè‡ªèº«åŒºå—é“¾è¾ƒçŸ­ï¼šè¯·æ±‚è·å–æ–°å—</li><li>å¦‚æœè‡ªèº«åŒºå—é“¾è¾ƒé•¿ï¼šå‘é€versionç»™å¯¹æ–¹</li></ul></li><li>æ³¨æ„ï¼šå‘é€versionæ˜¯å‘èµ·åŒæ­¥è¯·æ±‚çš„æ–¹å¼</li></ul><h3 id="3-æ¸…å•å¤„ç†-handleInv"><a href="#3-æ¸…å•å¤„ç†-handleInv" class="headerlink" title="3. æ¸…å•å¤„ç† (handleInv)"></a>3. æ¸…å•å¤„ç† (handleInv)</h3><ul><li>æ¥æ”¶å‘é€æ–¹çš„Invæ¸…å•<ul><li>åŒ…å«å—ä¿¡æ¯å’Œäº¤æ˜“ä¿¡æ¯</li></ul></li><li>åˆ†ææ¸…å•å†…å®¹<ul><li>ç¡®å®šéœ€è¦ä¸‹è½½çš„å†…å®¹</li></ul></li><li>è°ƒç”¨getDataæ‰§è¡Œå®é™…ä¸‹è½½</li></ul><h3 id="4-åŒºå—å¤„ç†-handleBlock"><a href="#4-åŒºå—å¤„ç†-handleBlock" class="headerlink" title="4. åŒºå—å¤„ç† (handleBlock)"></a>4. åŒºå—å¤„ç† (handleBlock)</h3><ul><li>æ¥æ”¶æ–°åŒºå—</li><li>éªŒè¯åŒºå—æœ‰æ•ˆæ€§</li><li>å°†æ–°åŒºå—æ·»åŠ åˆ°æœ¬åœ°é“¾ä¸­</li><li>æ›´æ–°åŒºå—é“¾çŠ¶æ€</li></ul><h3 id="5-äº¤æ˜“å¤„ç†-handleTx"><a href="#5-äº¤æ˜“å¤„ç†-handleTx" class="headerlink" title="5. äº¤æ˜“å¤„ç† (handleTx)"></a>5. äº¤æ˜“å¤„ç† (handleTx)</h3><ul><li>æ¥æ”¶æ–°äº¤æ˜“</li><li>éªŒè¯äº¤æ˜“æœ‰æ•ˆæ€§</li><li>å°†äº¤æ˜“åŠ å…¥å†…å­˜æ± </li><li>å‡†å¤‡æ‰“åŒ…æ–°åŒºå—</li></ul><h2 id="å‘é€æ–¹æµç¨‹"><a href="#å‘é€æ–¹æµç¨‹" class="headerlink" title="å‘é€æ–¹æµç¨‹"></a>å‘é€æ–¹æµç¨‹</h2><h3 id="1-æœåŠ¡å¯åŠ¨"><a href="#1-æœåŠ¡å¯åŠ¨" class="headerlink" title="1. æœåŠ¡å¯åŠ¨"></a>1. æœåŠ¡å¯åŠ¨</h3><ul><li>è°ƒç”¨ <code>startServer</code></li><li>åˆå§‹åŒ–ç½‘ç»œæœåŠ¡</li><li>å‡†å¤‡å“åº”è¯·æ±‚</li></ul><h3 id="2-åŒºå—è·å–è¯·æ±‚å¤„ç†-handleGetBlock"><a href="#2-åŒºå—è·å–è¯·æ±‚å¤„ç†-handleGetBlock" class="headerlink" title="2. åŒºå—è·å–è¯·æ±‚å¤„ç† (handleGetBlock)"></a>2. åŒºå—è·å–è¯·æ±‚å¤„ç† (handleGetBlock)</h3><ul><li>æ¥æ”¶è·å–åŒºå—è¯·æ±‚</li><li>æŸ¥æ‰¾è¯·æ±‚çš„åŒºå—</li><li>å‡†å¤‡åŒºå—æ•°æ®</li><li>å‘é€åŒºå—ä¿¡æ¯</li></ul><h3 id="3-æ•°æ®è¯·æ±‚å¤„ç†-getData"><a href="#3-æ•°æ®è¯·æ±‚å¤„ç†-getData" class="headerlink" title="3. æ•°æ®è¯·æ±‚å¤„ç† (getData)"></a>3. æ•°æ®è¯·æ±‚å¤„ç† (getData)</h3><ul><li>æ¥æ”¶å…·ä½“æ•°æ®è¯·æ±‚</li><li>æ ¹æ®è¯·æ±‚ç±»å‹å¤„ç†<ul><li>åŒºå—è¯·æ±‚ï¼šè¿”å›å®Œæ•´åŒºå—</li><li>äº¤æ˜“è¯·æ±‚ï¼šè¿”å›äº¤æ˜“è¯¦æƒ…</li></ul></li><li>å‘é€è¯·æ±‚çš„æ•°æ®</li></ul><h2 id="é€šä¿¡è¦ç‚¹"><a href="#é€šä¿¡è¦ç‚¹" class="headerlink" title="é€šä¿¡è¦ç‚¹"></a>é€šä¿¡è¦ç‚¹</h2><ol><li><p><strong>ç‰ˆæœ¬åŒæ­¥æœºåˆ¶</strong></p><ul><li>é€šè¿‡versionæ¶ˆæ¯è¿›è¡ŒåŒºå—é“¾çŠ¶æ€åŒæ­¥</li><li>ç¡®ä¿èŠ‚ç‚¹é—´æ•°æ®ä¸€è‡´æ€§</li></ul></li><li><p><strong>æ•°æ®ä¼ è¾“æµç¨‹</strong></p><ul><li>Invæ¸…å•ä½œä¸ºæ•°æ®ç´¢å¼•</li><li>getDataè¯·æ±‚å…·ä½“æ•°æ®</li><li>åˆ†å—ä¼ è¾“é¿å…ç½‘ç»œæ‹¥å µ</li></ul></li><li><p><strong>çŠ¶æ€ç»´æŠ¤</strong></p><ul><li>è·Ÿè¸ªå¾…ä¸‹è½½çš„åŒºå—</li><li>ç®¡ç†äº¤æ˜“å†…å­˜æ± </li><li>ç»´æŠ¤èŠ‚ç‚¹è¿æ¥çŠ¶æ€</li></ul></li><li><p><strong>é”™è¯¯å¤„ç†</strong></p><ul><li>ç½‘ç»œæ–­å¼€é‡è¿</li><li>æ•°æ®éªŒè¯å¤±è´¥å¤„ç†</li><li>è¶…æ—¶é‡è¯•æœºåˆ¶</li></ul></li></ol><p>é€šè¿‡è¿™ç§è®¾è®¡ï¼Œæˆ‘ä»¬å®ç°äº†ä¸€ä¸ªå¯é çš„P2Pç½‘ç»œé€šä¿¡æœºåˆ¶ï¼Œç¡®ä¿äº†åŒºå—é“¾ç½‘ç»œçš„æ­£å¸¸è¿è¡Œå’Œæ•°æ®åŒæ­¥ã€‚</p>]]></content>
    
    
    <summary type="html">è¯¦ç»†ä»‹ç»åŒºå—é“¾P2Pç½‘ç»œä¸­èŠ‚ç‚¹é—´çš„é€šä¿¡æµç¨‹</summary>
    
    
    
    <category term="åŒºå—é“¾å¼€å‘" scheme="https://eatbreads.github.io/categories/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%BC%80%E5%8F%91/"/>
    
    
    <category term="åŒºå—é“¾" scheme="https://eatbreads.github.io/tags/%E5%8C%BA%E5%9D%97%E9%93%BE/"/>
    
    <category term="ç½‘ç»œé€šä¿¡" scheme="https://eatbreads.github.io/tags/%E7%BD%91%E7%BB%9C%E9%80%9A%E4%BF%A1/"/>
    
    <category term="æµç¨‹å›¾" scheme="https://eatbreads.github.io/tags/%E6%B5%81%E7%A8%8B%E5%9B%BE/"/>
    
  </entry>
  
  <entry>
    <title>åŒºå—é“¾ç½‘ç»œéƒ¨åˆ†å®ç°</title>
    <link href="https://eatbreads.github.io/posts/5a225ca.html"/>
    <id>https://eatbreads.github.io/posts/5a225ca.html</id>
    <published>2025-04-30T15:32:26.000Z</published>
    <updated>2025-04-30T15:36:27.225Z</updated>
    
    <content type="html"><![CDATA[<h1>åŒºå—é“¾ç½‘ç»œå®ç°è¯¦è§£</h1><h2 id="ç½‘ç»œæ¶æ„">ç½‘ç»œæ¶æ„</h2><p>åŒºå—é“¾ç½‘ç»œé‡‡ç”¨P2Pï¼ˆç‚¹å¯¹ç‚¹ï¼‰æ‹“æ‰‘æ‰å¹³ç»“æ„ï¼Œæ¯ä¸ªèŠ‚ç‚¹åŒæ—¶å…·å¤‡æœåŠ¡å™¨å’Œå®¢æˆ·ç«¯çš„åŒé‡èº«ä»½ã€‚è¿™ç§å»ä¸­å¿ƒåŒ–çš„æ¶æ„ç¡®ä¿äº†ç½‘ç»œçš„å¥å£®æ€§å’Œå¯æ‰©å±•æ€§ã€‚</p><h3 id="èŠ‚ç‚¹ç±»å‹">èŠ‚ç‚¹ç±»å‹</h3><ol><li><p><strong>çŸ¿å·¥èŠ‚ç‚¹</strong></p><ul><li>è´Ÿè´£æ‰“åŒ…äº¤æ˜“</li><li>è¿›è¡Œå·¥ä½œé‡è¯æ˜</li><li>å¹¿æ’­æ–°åŒºå—</li></ul></li><li><p><strong>å…¨èŠ‚ç‚¹</strong></p><ul><li>å­˜å‚¨å®Œæ•´çš„åŒºå—é“¾æ•°æ®</li><li>æä¾›ç½‘ç»œè·¯ç”±åŠŸèƒ½</li><li>éªŒè¯äº¤æ˜“å’ŒåŒºå—</li></ul></li><li><p><strong>SPVèŠ‚ç‚¹</strong>ï¼ˆç®€å•æ”¯ä»˜éªŒè¯ï¼‰</p><ul><li>åªå­˜å‚¨åŒºå—å¤´</li><li>ç»´æŠ¤ç‰¹å®šäº¤æ˜“å­é›†</li><li>è½»é‡çº§å®¢æˆ·ç«¯å®ç°</li></ul></li></ol><h2 id="ç½‘ç»œé€šä¿¡æµç¨‹">ç½‘ç»œé€šä¿¡æµç¨‹</h2><h3 id="1-ç‰ˆæœ¬éªŒè¯">1. ç‰ˆæœ¬éªŒè¯</h3><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Versionæ¶ˆæ¯ç»“æ„</span></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Version</span> &#123;</span><br><span class="line">    version: <span class="type">i32</span>,</span><br><span class="line">    best_height: <span class="type">i32</span>,</span><br><span class="line">    addr_from: <span class="type">String</span>,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="2-åŒºå—åŒæ­¥">2. åŒºå—åŒæ­¥</h3><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// GetBlocksæ¶ˆæ¯ç»“æ„</span></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">GetBlocks</span> &#123;</span><br><span class="line">    addr_from: <span class="type">String</span>,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Invæ¶ˆæ¯ç»“æ„</span></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Inv</span> &#123;</span><br><span class="line">    addr_from: <span class="type">String</span>,</span><br><span class="line">    type_: <span class="type">String</span>,  <span class="comment">// &quot;block&quot; æˆ– &quot;tx&quot;</span></span><br><span class="line">    items: <span class="type">Vec</span>&lt;<span class="type">String</span>&gt;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="3-æ•°æ®è¯·æ±‚">3. æ•°æ®è¯·æ±‚</h3><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// GetDataæ¶ˆæ¯ç»“æ„</span></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">GetData</span> &#123;</span><br><span class="line">    addr_from: <span class="type">String</span>,</span><br><span class="line">    type_: <span class="type">String</span>,</span><br><span class="line">    id: <span class="type">String</span>,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="æ ¸å¿ƒç»„ä»¶å®ç°">æ ¸å¿ƒç»„ä»¶å®ç°</h2><h3 id="1-æœåŠ¡å™¨å¯åŠ¨">1. æœåŠ¡å™¨å¯åŠ¨</h3><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">fn</span> <span class="title function_">start_server</span>(&amp;<span class="keyword">mut</span> <span class="keyword">self</span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">listener</span> = TcpListener::<span class="title function_ invoke__">bind</span>(&amp;<span class="keyword">self</span>.node_addr)?;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// éä¸­å¿ƒèŠ‚ç‚¹éœ€è¦åŒæ­¥</span></span><br><span class="line">    <span class="keyword">if</span> !<span class="keyword">self</span>.is_central_node &#123;</span><br><span class="line">        <span class="keyword">self</span>.<span class="title function_ invoke__">send_version</span>(CENTRAL_NODE_ADDR);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// ä¸»å¾ªç¯å¤„ç†è¿æ¥</span></span><br><span class="line">    <span class="keyword">for</span> <span class="variable">stream</span> <span class="keyword">in</span> listener.<span class="title function_ invoke__">incoming</span>() &#123;</span><br><span class="line">        <span class="keyword">self</span>.<span class="title function_ invoke__">handle_connection</span>(stream?);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="2-è¿æ¥å¤„ç†">2. è¿æ¥å¤„ç†</h3><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">fn</span> <span class="title function_">handle_connection</span>(&amp;<span class="keyword">mut</span> <span class="keyword">self</span>, <span class="keyword">mut</span> stream: TcpStream) &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">command</span> = <span class="keyword">self</span>.<span class="title function_ invoke__">read_command</span>(&amp;<span class="keyword">mut</span> stream)?;</span><br><span class="line">    <span class="keyword">match</span> command.<span class="title function_ invoke__">as_str</span>() &#123;</span><br><span class="line">        <span class="string">&quot;version&quot;</span> =&gt; <span class="keyword">self</span>.<span class="title function_ invoke__">handle_version</span>(&amp;<span class="keyword">mut</span> stream),</span><br><span class="line">        <span class="string">&quot;getblocks&quot;</span> =&gt; <span class="keyword">self</span>.<span class="title function_ invoke__">handle_get_blocks</span>(&amp;<span class="keyword">mut</span> stream),</span><br><span class="line">        <span class="string">&quot;inv&quot;</span> =&gt; <span class="keyword">self</span>.<span class="title function_ invoke__">handle_inv</span>(&amp;<span class="keyword">mut</span> stream),</span><br><span class="line">        <span class="string">&quot;getdata&quot;</span> =&gt; <span class="keyword">self</span>.<span class="title function_ invoke__">handle_get_data</span>(&amp;<span class="keyword">mut</span> stream),</span><br><span class="line">        <span class="string">&quot;block&quot;</span> =&gt; <span class="keyword">self</span>.<span class="title function_ invoke__">handle_block</span>(&amp;<span class="keyword">mut</span> stream),</span><br><span class="line">        <span class="string">&quot;tx&quot;</span> =&gt; <span class="keyword">self</span>.<span class="title function_ invoke__">handle_tx</span>(&amp;<span class="keyword">mut</span> stream),</span><br><span class="line">        _ =&gt; <span class="built_in">println!</span>(<span class="string">&quot;Unknown command&quot;</span>),</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="3-ç‰ˆæœ¬å¤„ç†">3. ç‰ˆæœ¬å¤„ç†</h3><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">fn</span> <span class="title function_">handle_version</span>(&amp;<span class="keyword">mut</span> <span class="keyword">self</span>, stream: &amp;<span class="keyword">mut</span> TcpStream) &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">version</span>: Version = <span class="title function_ invoke__">deserialize</span>(stream)?;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// æ£€æŸ¥åŒºå—é«˜åº¦</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">self</span>.blockchain.<span class="title function_ invoke__">get_best_height</span>() &lt; version.best_height &#123;</span><br><span class="line">        <span class="keyword">self</span>.<span class="title function_ invoke__">send_get_blocks</span>(version.addr_from);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="4-åŒºå—è¯·æ±‚å¤„ç†">4. åŒºå—è¯·æ±‚å¤„ç†</h3><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">fn</span> <span class="title function_">handle_get_blocks</span>(&amp;<span class="keyword">mut</span> <span class="keyword">self</span>, stream: &amp;<span class="keyword">mut</span> TcpStream) &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">payload</span>: GetBlocks = <span class="title function_ invoke__">deserialize</span>(stream)?;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">blocks</span> = <span class="keyword">self</span>.blockchain.<span class="title function_ invoke__">get_block_hashes</span>();</span><br><span class="line">    <span class="keyword">self</span>.<span class="title function_ invoke__">send_inv</span>(payload.addr_from, <span class="string">&quot;block&quot;</span>, blocks);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="5-æ¸…å•å¤„ç†">5. æ¸…å•å¤„ç†</h3><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">fn</span> <span class="title function_">handle_inv</span>(&amp;<span class="keyword">mut</span> <span class="keyword">self</span>, stream: &amp;<span class="keyword">mut</span> TcpStream) &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">inv</span>: Inv = <span class="title function_ invoke__">deserialize</span>(stream)?;</span><br><span class="line">    <span class="keyword">if</span> inv.type_ == <span class="string">&quot;block&quot;</span> &#123;</span><br><span class="line">        <span class="keyword">self</span>.blocks_in_transit = inv.items;</span><br><span class="line">        <span class="keyword">self</span>.<span class="title function_ invoke__">send_get_data</span>(inv.addr_from, <span class="string">&quot;block&quot;</span>, <span class="keyword">self</span>.blocks_in_transit[<span class="number">0</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="6-æ•°æ®è¯·æ±‚å¤„ç†">6. æ•°æ®è¯·æ±‚å¤„ç†</h3><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">fn</span> <span class="title function_">handle_get_data</span>(&amp;<span class="keyword">mut</span> <span class="keyword">self</span>, stream: &amp;<span class="keyword">mut</span> TcpStream) &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">request</span>: GetData = <span class="title function_ invoke__">deserialize</span>(stream)?;</span><br><span class="line">    <span class="keyword">if</span> request.type_ == <span class="string">&quot;block&quot;</span> &#123;</span><br><span class="line">        <span class="keyword">let</span> <span class="variable">block</span> = <span class="keyword">self</span>.blockchain.<span class="title function_ invoke__">get_block</span>(&amp;request.id)?;</span><br><span class="line">        <span class="keyword">self</span>.<span class="title function_ invoke__">send_block</span>(request.addr_from, block);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="7-åŒºå—å¤„ç†">7. åŒºå—å¤„ç†</h3><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">fn</span> <span class="title function_">handle_block</span>(&amp;<span class="keyword">mut</span> <span class="keyword">self</span>, stream: &amp;<span class="keyword">mut</span> TcpStream) &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">block</span>: Block = <span class="title function_ invoke__">deserialize</span>(stream)?;</span><br><span class="line">    <span class="keyword">self</span>.blockchain.<span class="title function_ invoke__">add_block</span>(block)?;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// ç»§ç»­è¯·æ±‚å…¶ä»–åŒºå—</span></span><br><span class="line">    <span class="keyword">if</span> !<span class="keyword">self</span>.blocks_in_transit.<span class="title function_ invoke__">is_empty</span>() &#123;</span><br><span class="line">        <span class="keyword">self</span>.blocks_in_transit.<span class="title function_ invoke__">remove</span>(<span class="number">0</span>);</span><br><span class="line">        <span class="keyword">if</span> !<span class="keyword">self</span>.blocks_in_transit.<span class="title function_ invoke__">is_empty</span>() &#123;</span><br><span class="line">            <span class="keyword">let</span> <span class="variable">next_hash</span> = <span class="keyword">self</span>.blocks_in_transit[<span class="number">0</span>];</span><br><span class="line">            <span class="keyword">self</span>.<span class="title function_ invoke__">send_get_data</span>(stream.<span class="title function_ invoke__">peer_addr</span>()?, <span class="string">&quot;block&quot;</span>, next_hash);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="8-äº¤æ˜“å¤„ç†">8. äº¤æ˜“å¤„ç†</h3><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">fn</span> <span class="title function_">handle_tx</span>(&amp;<span class="keyword">mut</span> <span class="keyword">self</span>, stream: &amp;<span class="keyword">mut</span> TcpStream) &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">tx</span>: Transaction = <span class="title function_ invoke__">deserialize</span>(stream)?;</span><br><span class="line">    <span class="keyword">self</span>.mempool.<span class="title function_ invoke__">insert</span>(tx.id.<span class="title function_ invoke__">clone</span>(), tx);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// ä½œä¸ºçŸ¿å·¥èŠ‚ç‚¹ï¼Œæ”¶é›†è¶³å¤Ÿäº¤æ˜“åå¼€å§‹æŒ–çŸ¿</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">self</span>.is_miner &amp;&amp; <span class="keyword">self</span>.mempool.<span class="title function_ invoke__">len</span>() &gt;= MINING_THRESHOLD &#123;</span><br><span class="line">        <span class="keyword">let</span> <span class="variable">txs</span>: <span class="type">Vec</span>&lt;Transaction&gt; = <span class="keyword">self</span>.mempool.<span class="title function_ invoke__">values</span>().<span class="title function_ invoke__">cloned</span>().<span class="title function_ invoke__">collect</span>();</span><br><span class="line">        <span class="keyword">self</span>.<span class="title function_ invoke__">mine_block</span>(txs);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">è¯¦ç»†ä»‹ç»åŒºå—é“¾P2Pç½‘ç»œçš„å®ç°åŸç†å’Œæ ¸å¿ƒç»„ä»¶</summary>
    
    
    
    <category term="åŒºå—é“¾å¼€å‘" scheme="https://eatbreads.github.io/categories/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%BC%80%E5%8F%91/"/>
    
    
    <category term="åŒºå—é“¾" scheme="https://eatbreads.github.io/tags/%E5%8C%BA%E5%9D%97%E9%93%BE/"/>
    
    <category term="Rust" scheme="https://eatbreads.github.io/tags/Rust/"/>
    
    <category term="P2Pç½‘ç»œ" scheme="https://eatbreads.github.io/tags/P2P%E7%BD%91%E7%BB%9C/"/>
    
  </entry>
  
  <entry>
    <title>Pythonè°ƒç”¨å¤§æ¨¡å‹APIå®æˆ˜</title>
    <link href="https://eatbreads.github.io/posts/ffa1ef1b.html"/>
    <id>https://eatbreads.github.io/posts/ffa1ef1b.html</id>
    <published>2025-04-30T15:17:28.000Z</published>
    <updated>2025-04-30T15:26:00.791Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Pythonè°ƒç”¨å¤§æ¨¡å‹APIå®æˆ˜æ•™ç¨‹"><a href="#Pythonè°ƒç”¨å¤§æ¨¡å‹APIå®æˆ˜æ•™ç¨‹" class="headerlink" title="Pythonè°ƒç”¨å¤§æ¨¡å‹APIå®æˆ˜æ•™ç¨‹"></a>Pythonè°ƒç”¨å¤§æ¨¡å‹APIå®æˆ˜æ•™ç¨‹</h1><h2 id="ç¯å¢ƒå‡†å¤‡"><a href="#ç¯å¢ƒå‡†å¤‡" class="headerlink" title="ç¯å¢ƒå‡†å¤‡"></a>ç¯å¢ƒå‡†å¤‡</h2><p>é¦–å…ˆéœ€è¦å®‰è£…openaiåº“ï¼š<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install openai</span><br></pre></td></tr></table></figure></p><h2 id="APIç”³è¯·"><a href="#APIç”³è¯·" class="headerlink" title="APIç”³è¯·"></a>APIç”³è¯·</h2><ol><li>è®¿é—® Deepseek å®˜ç½‘æ³¨å†Œè´¦å·</li><li>åœ¨ä¸ªäººä¸­å¿ƒç”³è¯· API Key</li><li>è·å–åˆ°å½¢å¦‚ <code>sk-0f2245****a0bb3f1e</code> çš„å¯†é’¥</li><li>å……å€¼ä»¥è·å¾—APIè°ƒç”¨é¢åº¦</li></ol><h2 id="ä»£ç å®ç°"><a href="#ä»£ç å®ç°" class="headerlink" title="ä»£ç å®ç°"></a>ä»£ç å®ç°</h2><h3 id="1-åŸºç¡€é…ç½®"><a href="#1-åŸºç¡€é…ç½®" class="headerlink" title="1. åŸºç¡€é…ç½®"></a>1. åŸºç¡€é…ç½®</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> openai <span class="keyword">import</span> OpenAI</span><br><span class="line"><span class="keyword">from</span> datetime <span class="keyword">import</span> datetime</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ›å»ºOpenAIå®¢æˆ·ç«¯</span></span><br><span class="line">client = OpenAI(</span><br><span class="line">    api_key=<span class="string">&quot;your-api-key&quot;</span>,  <span class="comment"># æ›¿æ¢ä¸ºä½ çš„APIå¯†é’¥</span></span><br><span class="line">    base_url=<span class="string">&quot;https://api.deepseek.com/v1&quot;</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure><h3 id="2-å®šä¹‰Promptæ¨¡æ¿"><a href="#2-å®šä¹‰Promptæ¨¡æ¿" class="headerlink" title="2. å®šä¹‰Promptæ¨¡æ¿"></a>2. å®šä¹‰Promptæ¨¡æ¿</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">PROMPT_TEMPLATES = &#123;</span><br><span class="line">    <span class="string">&quot;student_info&quot;</span>: &#123;</span><br><span class="line">        <span class="string">&quot;system&quot;</span>: <span class="string">&quot;&quot;&quot;ä½ æ˜¯ä¸€ä¸ªä¸“æ³¨äºå­¦ç”ŸåŸºæœ¬ä¿¡æ¯åˆ†æçš„æ•™è‚²æ•°æ®ä¸“å®¶ã€‚</span></span><br><span class="line"><span class="string">        - æ“…é•¿å¤„ç†å­¦ç”Ÿä¸ªäººä¿¡æ¯ã€äººå£ç»Ÿè®¡å­¦ç‰¹å¾</span></span><br><span class="line"><span class="string">        - æ³¨é‡å­¦ç”Ÿä¿¡æ¯çš„éšç§ä¿æŠ¤</span></span><br><span class="line"><span class="string">        - ä¸“æ³¨äºäººå£ç‰¹å¾ç»Ÿè®¡å’Œåˆ†å¸ƒåˆ†æ&quot;&quot;&quot;</span>,</span><br><span class="line">        </span><br><span class="line">        <span class="string">&quot;background&quot;</span>: <span class="string">&quot;&quot;&quot;æ­£åœ¨åˆ†æå­¦ç”ŸåŸºæœ¬ä¿¡æ¯æ•°æ®ï¼š</span></span><br><span class="line"><span class="string">        - æ•°æ®ç±»å‹ï¼šå­¦ç”Ÿä¸ªäººåŸºæœ¬ä¿¡æ¯</span></span><br><span class="line"><span class="string">        - åŒ…å«å­—æ®µï¼šå­¦å·ã€å§“åã€æ€§åˆ«ã€å¹´é¾„ã€ç±è´¯ç­‰</span></span><br><span class="line"><span class="string">        - åˆ†æç›®æ ‡ï¼šäº†è§£å­¦ç”Ÿç¾¤ä½“çš„åŸºæœ¬ç‰¹å¾åˆ†å¸ƒ&quot;&quot;&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment"># ... å…¶ä»–æ¨¡æ¿</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="3-æ•°æ®è¯»å–å‡½æ•°"><a href="#3-æ•°æ®è¯»å–å‡½æ•°" class="headerlink" title="3. æ•°æ®è¯»å–å‡½æ•°"></a>3. æ•°æ®è¯»å–å‡½æ•°</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">read_data_file</span>(<span class="params">file_path</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;è¯»å–æ•°æ®æ–‡ä»¶&quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">if</span> file_path.endswith(<span class="string">&#x27;.csv&#x27;</span>):</span><br><span class="line">        <span class="keyword">return</span> pd.read_csv(file_path)</span><br><span class="line">    <span class="keyword">elif</span> file_path.endswith(<span class="string">&#x27;.xlsx&#x27;</span>):</span><br><span class="line">        <span class="keyword">return</span> pd.read_excel(file_path)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">raise</span> ValueError(<span class="string">&quot;ä¸æ”¯æŒçš„æ–‡ä»¶æ ¼å¼ï¼Œè¯·ä½¿ç”¨ CSV æˆ– Excel æ–‡ä»¶&quot;</span>)</span><br></pre></td></tr></table></figure><h3 id="4-åˆ›å»ºåˆ†æè¯·æ±‚"><a href="#4-åˆ›å»ºåˆ†æè¯·æ±‚" class="headerlink" title="4. åˆ›å»ºåˆ†æè¯·æ±‚"></a>4. åˆ›å»ºåˆ†æè¯·æ±‚</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">create_analysis_request</span>(<span class="params">data_type, specific_task, data_file=<span class="literal">None</span></span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;åˆ›å»ºå¹¶å‘é€åˆ†æè¯·æ±‚&quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">if</span> data_type <span class="keyword">not</span> <span class="keyword">in</span> PROMPT_TEMPLATES:</span><br><span class="line">        <span class="keyword">raise</span> ValueError(<span class="string">f&quot;ä¸æ”¯æŒçš„æ•°æ®ç±»å‹: <span class="subst">&#123;data_type&#125;</span>&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    template = PROMPT_TEMPLATES[data_type]</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># æ·»åŠ æ•°æ®æ¦‚è§ˆ</span></span><br><span class="line">    data_overview = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">if</span> data_file:</span><br><span class="line">        df = read_data_file(data_file)</span><br><span class="line">        data_overview = <span class="string">f&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        æ•°æ®æ¦‚è§ˆï¼š</span></span><br><span class="line"><span class="string">        - æ€»è®°å½•æ•°ï¼š<span class="subst">&#123;<span class="built_in">len</span>(df)&#125;</span></span></span><br><span class="line"><span class="string">        - å­—æ®µåˆ—è¡¨ï¼š<span class="subst">&#123;<span class="string">&#x27;, &#x27;</span>.join(df.columns)&#125;</span></span></span><br><span class="line"><span class="string">        - æ•°æ®ç¤ºä¾‹ï¼š\n<span class="subst">&#123;df.head(<span class="number">3</span>).to_string()&#125;</span></span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># å‘é€è¯·æ±‚</span></span><br><span class="line">    response = client.chat.completions.create(</span><br><span class="line">        model=<span class="string">&quot;deepseek-chat&quot;</span>,</span><br><span class="line">        messages=[</span><br><span class="line">            &#123;<span class="string">&quot;role&quot;</span>: <span class="string">&quot;system&quot;</span>, <span class="string">&quot;content&quot;</span>: template[<span class="string">&quot;system&quot;</span>]&#125;,</span><br><span class="line">            &#123;<span class="string">&quot;role&quot;</span>: <span class="string">&quot;user&quot;</span>, <span class="string">&quot;content&quot;</span>: template[<span class="string">&quot;background&quot;</span>] + data_overview&#125;,</span><br><span class="line">            &#123;<span class="string">&quot;role&quot;</span>: <span class="string">&quot;user&quot;</span>, <span class="string">&quot;content&quot;</span>: specific_task&#125;</span><br><span class="line">        ],</span><br><span class="line">        temperature=<span class="number">0.3</span></span><br><span class="line">    )</span><br><span class="line">    <span class="keyword">return</span> response.choices[<span class="number">0</span>].message.content</span><br></pre></td></tr></table></figure><h3 id="5-ä½¿ç”¨ç¤ºä¾‹"><a href="#5-ä½¿ç”¨ç¤ºä¾‹" class="headerlink" title="5. ä½¿ç”¨ç¤ºä¾‹"></a>5. ä½¿ç”¨ç¤ºä¾‹</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å®šä¹‰åˆ†æä»»åŠ¡</span></span><br><span class="line">specific_task = <span class="string">&quot;&quot;&quot;è¯·åˆ†æä»¥ä¸‹å†…å®¹ï¼š</span></span><br><span class="line"><span class="string">1. æ•°æ®å®Œæ•´æ€§æ£€æŸ¥</span></span><br><span class="line"><span class="string">2. ä¸»è¦æŒ‡æ ‡çš„åˆ†å¸ƒæƒ…å†µ</span></span><br><span class="line"><span class="string">3. å¼‚å¸¸å€¼æ£€æµ‹å’Œå¤„ç†å»ºè®®</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">è¾“å‡ºè¦æ±‚ï¼š</span></span><br><span class="line"><span class="string">- æ ¼å¼ï¼šåˆ†ç‚¹åˆ—å‡º</span></span><br><span class="line"><span class="string">- åŒ…å«å…·ä½“æ•°å€¼å’Œç™¾åˆ†æ¯”</span></span><br><span class="line"><span class="string">- æä¾›å¯è§†åŒ–å»ºè®®&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ‰§è¡Œåˆ†æ</span></span><br><span class="line">file_path = <span class="string">&quot;path/to/your/data.xlsx&quot;</span></span><br><span class="line">analysis_result = create_analysis_request(<span class="string">&quot;student_info&quot;</span>, specific_task, file_path)</span><br><span class="line"><span class="built_in">print</span>(analysis_result)</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">è¯¦ç»†ä»‹ç»å¦‚ä½•ä½¿ç”¨Pythonè°ƒç”¨å¤§æ¨¡å‹APIï¼ŒåŒ…æ‹¬ç¯å¢ƒé…ç½®ã€APIç”³è¯·å’Œä»£ç å®ç°</summary>
    
    
    
    <category term="ç¼–ç¨‹å¼€å‘" scheme="https://eatbreads.github.io/categories/%E7%BC%96%E7%A8%8B%E5%BC%80%E5%8F%91/"/>
    
    
    <category term="Python" scheme="https://eatbreads.github.io/tags/Python/"/>
    
    <category term="AI" scheme="https://eatbreads.github.io/tags/AI/"/>
    
    <category term="APIè°ƒç”¨" scheme="https://eatbreads.github.io/tags/API%E8%B0%83%E7%94%A8/"/>
    
  </entry>
  
  <entry>
    <title>Rustå‘½ä»¤è¡Œå‚æ•°è§£æ - clapåº“ä½¿ç”¨æŒ‡å—</title>
    <link href="https://eatbreads.github.io/posts/6d327ffd.html"/>
    <id>https://eatbreads.github.io/posts/6d327ffd.html</id>
    <published>2025-04-28T05:45:27.000Z</published>
    <updated>2025-04-28T05:46:42.298Z</updated>
    
    <content type="html"><![CDATA[<h1>Rustå‘½ä»¤è¡Œå‚æ•°è§£æï¼šclapåº“ä½¿ç”¨æŒ‡å—</h1><h2 id="ç®€ä»‹">ç®€ä»‹</h2><p>clap (Command Line Argument Parser) æ˜¯Rustç”Ÿæ€ç³»ç»Ÿä¸­æœ€æµè¡Œçš„å‘½ä»¤è¡Œå‚æ•°è§£æåº“ä¹‹ä¸€ã€‚å®ƒæä¾›äº†ç›´è§‚çš„APIå’Œä¸°å¯Œçš„åŠŸèƒ½ï¼Œä½¿å¾—æ„å»ºå‘½ä»¤è¡Œåº”ç”¨å˜å¾—ç®€å•ã€‚</p><h2 id="åŸºæœ¬ä½¿ç”¨">åŸºæœ¬ä½¿ç”¨</h2><h3 id="1-æ·»åŠ ä¾èµ–">1. æ·»åŠ ä¾èµ–</h3><figure class="highlight toml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">[dependencies]</span></span><br><span class="line"><span class="attr">clap</span> = <span class="string">&quot;2.33&quot;</span></span><br></pre></td></tr></table></figure><h3 id="2-åˆ›å»ºå‘½ä»¤è¡Œåº”ç”¨">2. åˆ›å»ºå‘½ä»¤è¡Œåº”ç”¨</h3><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">use</span> clap::&#123;App, Arg&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">app</span> = App::<span class="title function_ invoke__">new</span>(<span class="string">&quot;blockchain-demo&quot;</span>)    <span class="comment">// åº”ç”¨åç§°</span></span><br><span class="line">        .<span class="title function_ invoke__">version</span>(<span class="string">&quot;0.1&quot;</span>)                      <span class="comment">// ç‰ˆæœ¬å·</span></span><br><span class="line">        .<span class="title function_ invoke__">author</span>(<span class="string">&quot;Your Name&quot;</span>)                 <span class="comment">// ä½œè€…ä¿¡æ¯</span></span><br><span class="line">        .<span class="title function_ invoke__">about</span>(<span class="string">&quot;åŒºå—é“¾æ¼”ç¤ºç¨‹åº&quot;</span>);            <span class="comment">// åº”ç”¨æè¿°</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="3-æ·»åŠ å­å‘½ä»¤">3. æ·»åŠ å­å‘½ä»¤</h3><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="variable">app</span> = App::<span class="title function_ invoke__">new</span>(<span class="string">&quot;blockchain-demo&quot;</span>)</span><br><span class="line">    .<span class="title function_ invoke__">version</span>(<span class="string">&quot;0.1&quot;</span>)</span><br><span class="line">    .<span class="title function_ invoke__">author</span>(<span class="string">&quot;Your Name&quot;</span>)</span><br><span class="line">    .<span class="title function_ invoke__">about</span>(<span class="string">&quot;åŒºå—é“¾æ¼”ç¤ºç¨‹åº&quot;</span>)</span><br><span class="line">    .<span class="title function_ invoke__">subcommand</span>(App::<span class="title function_ invoke__">new</span>(<span class="string">&quot;printchain&quot;</span>))      <span class="comment">// æ·»åŠ æ— å‚æ•°å­å‘½ä»¤</span></span><br><span class="line">    .<span class="title function_ invoke__">subcommand</span>(</span><br><span class="line">        App::<span class="title function_ invoke__">new</span>(<span class="string">&quot;addblock&quot;</span>)                 <span class="comment">// æ·»åŠ å¸¦å‚æ•°å­å‘½ä»¤</span></span><br><span class="line">            .<span class="title function_ invoke__">arg</span>(Arg::<span class="title function_ invoke__">from_usage</span>(<span class="string">&quot;&lt;data&gt; &#x27;the blockchain data&#x27;&quot;</span>))</span><br><span class="line">    );</span><br></pre></td></tr></table></figure><h3 id="4-è§£æå‚æ•°">4. è§£æå‚æ•°</h3><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">matches</span> = app.<span class="title function_ invoke__">get_matches</span>();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ£€æŸ¥å­å‘½ä»¤</span></span><br><span class="line">    <span class="keyword">match</span> matches.<span class="title function_ invoke__">subcommand</span>() &#123;</span><br><span class="line">        (<span class="string">&quot;printchain&quot;</span>, <span class="title function_ invoke__">Some</span>(_)) =&gt; &#123;</span><br><span class="line">            <span class="comment">// å¤„ç†printchainå‘½ä»¤</span></span><br><span class="line">            <span class="built_in">println!</span>(<span class="string">&quot;æ‰“å°åŒºå—é“¾&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        (<span class="string">&quot;addblock&quot;</span>, <span class="title function_ invoke__">Some</span>(add_matches)) =&gt; &#123;</span><br><span class="line">            <span class="comment">// è·å–dataå‚æ•°</span></span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">let</span> <span class="variable">Some</span>(data) = add_matches.<span class="title function_ invoke__">value_of</span>(<span class="string">&quot;data&quot;</span>) &#123;</span><br><span class="line">                <span class="built_in">println!</span>(<span class="string">&quot;æ·»åŠ åŒºå—: &#123;&#125;&quot;</span>, data);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        _ =&gt; <span class="built_in">println!</span>(<span class="string">&quot;æœªçŸ¥å‘½ä»¤&quot;</span>),</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="å‚æ•°å¤„ç†æ–¹æ³•">å‚æ•°å¤„ç†æ–¹æ³•</h2><h3 id="1-æ£€æŸ¥å­å‘½ä»¤">1. æ£€æŸ¥å­å‘½ä»¤</h3><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> <span class="keyword">let</span> <span class="variable">Some</span>(<span class="keyword">ref</span> matches) = matches.<span class="title function_ invoke__">subcommand_matches</span>(<span class="string">&quot;addblock&quot;</span>) &#123;</span><br><span class="line">    <span class="comment">// å¤„ç†addblockå­å‘½ä»¤</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="2-è·å–å‚æ•°å€¼">2. è·å–å‚æ•°å€¼</h3><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> <span class="keyword">let</span> <span class="variable">Some</span>(value) = matches.<span class="title function_ invoke__">value_of</span>(<span class="string">&quot;å‚æ•°å&quot;</span>) &#123;</span><br><span class="line">    <span class="comment">// ä½¿ç”¨å‚æ•°å€¼</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="3-è·å–å¤šå€¼å‚æ•°">3. è·å–å¤šå€¼å‚æ•°</h3><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> <span class="keyword">let</span> <span class="variable">Some</span>(values) = matches.<span class="title function_ invoke__">values_of</span>(<span class="string">&quot;å‚æ•°å&quot;</span>) &#123;</span><br><span class="line">    <span class="keyword">for</span> <span class="variable">value</span> <span class="keyword">in</span> values &#123;</span><br><span class="line">        <span class="comment">// å¤„ç†æ¯ä¸ªå€¼</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="å‘½ä»¤è¡Œä½¿ç”¨ç¤ºä¾‹">å‘½ä»¤è¡Œä½¿ç”¨ç¤ºä¾‹</h2><h3 id="æŸ¥çœ‹å¸®åŠ©">æŸ¥çœ‹å¸®åŠ©</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cargo run -- --<span class="built_in">help</span></span><br></pre></td></tr></table></figure><p>è¾“å‡ºï¼š</p><figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">blockchain-demo 0.1</span><br><span class="line">Your Name</span><br><span class="line">åŒºå—é“¾æ¼”ç¤ºç¨‹åº</span><br><span class="line"></span><br><span class="line">USAGE:</span><br><span class="line">    blockchain-demo [SUBCOMMAND]</span><br><span class="line"></span><br><span class="line">FLAGS:</span><br><span class="line">    -h, <span class="params">--help</span>       Prints <span class="keyword">help</span> information</span><br><span class="line">    -V, <span class="params">--version</span>    Prints <span class="keyword">version</span> information</span><br><span class="line"></span><br><span class="line">SUBCOMMANDS:</span><br><span class="line">    addblock     </span><br><span class="line">    <span class="keyword">help</span>         Prints this message or the <span class="keyword">help</span> of the given subcommand<span class="params">(s)</span></span><br><span class="line">    printchain</span><br></pre></td></tr></table></figure><h3 id="æ‰§è¡Œå­å‘½ä»¤">æ‰§è¡Œå­å‘½ä»¤</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ‰“å°åŒºå—é“¾</span></span><br><span class="line">cargo run -- printchain</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ·»åŠ åŒºå—</span></span><br><span class="line">cargo run -- addblock <span class="string">&quot;è¿™æ˜¯ç¬¬ä¸€ä¸ªåŒºå—çš„æ•°æ®&quot;</span></span><br></pre></td></tr></table></figure><h2 id="é«˜çº§ç‰¹æ€§">é«˜çº§ç‰¹æ€§</h2><h3 id="1-å‚æ•°éªŒè¯">1. å‚æ•°éªŒè¯</h3><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">.<span class="title function_ invoke__">arg</span>(Arg::<span class="title function_ invoke__">with_name</span>(<span class="string">&quot;count&quot;</span>)</span><br><span class="line">    .<span class="title function_ invoke__">short</span>(<span class="string">&quot;c&quot;</span>)</span><br><span class="line">    .<span class="title function_ invoke__">long</span>(<span class="string">&quot;count&quot;</span>)</span><br><span class="line">    .<span class="title function_ invoke__">takes_value</span>(<span class="literal">true</span>)</span><br><span class="line">    .<span class="title function_ invoke__">validator</span>(|s| &#123;</span><br><span class="line">        s.parse::&lt;<span class="type">i32</span>&gt;()</span><br><span class="line">            .<span class="title function_ invoke__">map</span>(|_| ())</span><br><span class="line">            .<span class="title function_ invoke__">map_err</span>(|_| <span class="type">String</span>::<span class="title function_ invoke__">from</span>(<span class="string">&quot;å¿…é¡»æ˜¯æ•°å­—&quot;</span>))</span><br><span class="line">    &#125;))</span><br></pre></td></tr></table></figure><h3 id="2-é»˜è®¤å€¼">2. é»˜è®¤å€¼</h3><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">.<span class="title function_ invoke__">arg</span>(Arg::<span class="title function_ invoke__">with_name</span>(<span class="string">&quot;name&quot;</span>)</span><br><span class="line">    .<span class="title function_ invoke__">long</span>(<span class="string">&quot;name&quot;</span>)</span><br><span class="line">    .<span class="title function_ invoke__">default_value</span>(<span class="string">&quot;default&quot;</span>))</span><br></pre></td></tr></table></figure><h3 id="3-å‚æ•°ç»„">3. å‚æ•°ç»„</h3><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">.<span class="title function_ invoke__">args_group</span>(ArgGroup::<span class="title function_ invoke__">with_name</span>(<span class="string">&quot;group&quot;</span>)</span><br><span class="line">    .<span class="title function_ invoke__">args</span>(&amp;[<span class="string">&quot;arg1&quot;</span>, <span class="string">&quot;arg2&quot;</span>])</span><br><span class="line">    .<span class="title function_ invoke__">required</span>(<span class="literal">true</span>))</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">è¯¦ç»†ä»‹ç»Rustä¸­ä½¿ç”¨clapåº“è¿›è¡Œå‘½ä»¤è¡Œå‚æ•°è§£æçš„æ–¹æ³•ï¼ŒåŒ…æ‹¬åŸºæœ¬é…ç½®ã€å‚æ•°å®šä¹‰å’Œä½¿ç”¨ç¤ºä¾‹</summary>
    
    
    
    <category term="åç«¯å¼€å‘" scheme="https://eatbreads.github.io/categories/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/"/>
    
    
    <category term="Rust" scheme="https://eatbreads.github.io/tags/Rust/"/>
    
    <category term="å¼€å‘å·¥å…·" scheme="https://eatbreads.github.io/tags/%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/"/>
    
    <category term="CLI" scheme="https://eatbreads.github.io/tags/CLI/"/>
    
  </entry>
  
  <entry>
    <title>Sled - Rustçš„åµŒå…¥å¼é”®å€¼æ•°æ®åº“</title>
    <link href="https://eatbreads.github.io/posts/4e9334eb.html"/>
    <id>https://eatbreads.github.io/posts/4e9334eb.html</id>
    <published>2025-04-28T05:43:26.000Z</published>
    <updated>2025-04-28T05:44:49.167Z</updated>
    
    <content type="html"><![CDATA[<h1>Sledç®€ä»‹</h1><p>Sledæ˜¯ä¸€ä¸ªç”¨çº¯Rustå®ç°çš„åµŒå…¥å¼é”®å€¼æ•°æ®åº“ï¼Œå®ƒå…·æœ‰ä»¥ä¸‹ç‰¹ç‚¹ï¼š</p><ul><li>çº¯Rustå®ç°ï¼Œä¿è¯å†…å­˜å®‰å…¨</li><li>åµŒå…¥å¼è®¾è®¡ï¼Œæ— éœ€ç‹¬ç«‹æœåŠ¡å™¨</li><li>ç±»Redisçš„é”®å€¼å¯¹å­˜å‚¨</li><li>æœ¬åœ°æ–‡ä»¶æŒä¹…åŒ–</li><li>é«˜æ€§èƒ½å’Œå¯é æ€§</li></ul><h2 id="ä¸ä¼ ç»Ÿæ•°æ®åº“çš„åŒºåˆ«">ä¸ä¼ ç»Ÿæ•°æ®åº“çš„åŒºåˆ«</h2><h3 id="ä¼ ç»Ÿæ•°æ®åº“-å¦‚MySQL">ä¼ ç»Ÿæ•°æ®åº“(å¦‚MySQL)</h3><ul><li>éœ€è¦ç‹¬ç«‹çš„æ•°æ®åº“æœåŠ¡å™¨</li><li>éœ€è¦å¼€æ”¾ç½‘ç»œç«¯å£</li><li>å®¢æˆ·ç«¯-æœåŠ¡å™¨æ¶æ„</li><li>æ”¯æŒå¤æ‚çš„SQLæŸ¥è¯¢</li></ul><h3 id="åµŒå…¥å¼æ•°æ®åº“-å¦‚Sled">åµŒå…¥å¼æ•°æ®åº“(å¦‚Sled)</h3><ul><li>ç›´æ¥åµŒå…¥åº”ç”¨ç¨‹åº</li><li>ä½¿ç”¨æœ¬åœ°æ–‡ä»¶å­˜å‚¨</li><li>æ— éœ€ç½‘ç»œè¿æ¥</li><li>ç®€å•çš„é”®å€¼å¯¹æ“ä½œ</li></ul><h2 id="åŸºæœ¬ä½¿ç”¨">åŸºæœ¬ä½¿ç”¨</h2><h3 id="1-æ·»åŠ ä¾èµ–">1. æ·»åŠ ä¾èµ–</h3><figure class="highlight toml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">[dependencies]</span></span><br><span class="line"><span class="attr">sled</span> = <span class="string">&quot;0.34&quot;</span></span><br></pre></td></tr></table></figure><h3 id="2-æ‰“å¼€æ•°æ®åº“">2. æ‰“å¼€æ•°æ®åº“</h3><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">use</span> sled::Db;</span><br><span class="line"></span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() <span class="punctuation">-&gt;</span> sled::<span class="type">Result</span>&lt;()&gt; &#123;</span><br><span class="line">    <span class="comment">// æ‰“å¼€æ•°æ®åº“ï¼Œå¦‚æœä¸å­˜åœ¨ä¼šè‡ªåŠ¨åˆ›å»º</span></span><br><span class="line">    <span class="keyword">let</span> <span class="variable">db</span> = sled::<span class="title function_ invoke__">open</span>(<span class="string">&quot;data/blocks&quot;</span>)?;</span><br><span class="line">    <span class="title function_ invoke__">Ok</span>(())</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="3-åŸºæœ¬æ“ä½œ">3. åŸºæœ¬æ“ä½œ</h3><h4 id="å­˜å‚¨æ•°æ®">å­˜å‚¨æ•°æ®</h4><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ’å…¥é”®å€¼å¯¹</span></span><br><span class="line">db.<span class="title function_ invoke__">insert</span>(<span class="string">&quot;key&quot;</span>, <span class="string">&quot;value&quot;</span>)?;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä½¿ç”¨å­—èŠ‚æ•°ç»„</span></span><br><span class="line">db.<span class="title function_ invoke__">insert</span>(<span class="string">b&quot;key&quot;</span>, <span class="string">b&quot;value&quot;</span>)?;</span><br></pre></td></tr></table></figure><h4 id="è¯»å–æ•°æ®">è¯»å–æ•°æ®</h4><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// è·å–å€¼</span></span><br><span class="line"><span class="keyword">match</span> db.<span class="title function_ invoke__">get</span>(<span class="string">&quot;key&quot;</span>)? &#123;</span><br><span class="line">    <span class="title function_ invoke__">Some</span>(value) =&gt; <span class="built_in">println!</span>(<span class="string">&quot;æ‰¾åˆ°å€¼: &#123;:?&#125;&quot;</span>, value),</span><br><span class="line">    <span class="literal">None</span> =&gt; <span class="built_in">println!</span>(<span class="string">&quot;æœªæ‰¾åˆ°å€¼&quot;</span>),</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="åˆ é™¤æ•°æ®">åˆ é™¤æ•°æ®</h4><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// åˆ é™¤é”®å€¼å¯¹</span></span><br><span class="line">db.<span class="title function_ invoke__">remove</span>(<span class="string">&quot;key&quot;</span>)?;</span><br></pre></td></tr></table></figure><h4 id="æŒä¹…åŒ–">æŒä¹…åŒ–</h4><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ç¡®ä¿æ•°æ®å†™å…¥ç£ç›˜</span></span><br><span class="line">db.<span class="title function_ invoke__">flush</span>()?;</span><br></pre></td></tr></table></figure><h2 id="é«˜çº§ç‰¹æ€§">é«˜çº§ç‰¹æ€§</h2><h3 id="1-åŸå­æ“ä½œ">1. åŸå­æ“ä½œ</h3><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ¯”è¾ƒå¹¶è®¾ç½®</span></span><br><span class="line">db.<span class="title function_ invoke__">compare_and_swap</span>(<span class="string">&quot;key&quot;</span>, <span class="title function_ invoke__">Some</span>(<span class="string">&quot;old&quot;</span>), <span class="title function_ invoke__">Some</span>(<span class="string">&quot;new&quot;</span>))?;</span><br></pre></td></tr></table></figure><h3 id="2-æ‰¹é‡æ“ä½œ">2. æ‰¹é‡æ“ä½œ</h3><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="variable">batch</span> = sled::Batch::<span class="title function_ invoke__">default</span>()</span><br><span class="line">    .<span class="title function_ invoke__">insert</span>(<span class="string">b&quot;k1&quot;</span>, <span class="string">b&quot;v1&quot;</span>)</span><br><span class="line">    .<span class="title function_ invoke__">insert</span>(<span class="string">b&quot;k2&quot;</span>, <span class="string">b&quot;v2&quot;</span>)</span><br><span class="line">    .<span class="title function_ invoke__">remove</span>(<span class="string">b&quot;k3&quot;</span>);</span><br><span class="line">db.<span class="title function_ invoke__">apply_batch</span>(batch)?;</span><br></pre></td></tr></table></figure><h3 id="3-äº‹åŠ¡æ”¯æŒ">3. äº‹åŠ¡æ”¯æŒ</h3><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="variable">tree</span> = db.<span class="title function_ invoke__">open_tree</span>(<span class="string">&quot;my_tree&quot;</span>)?;</span><br><span class="line">tree.<span class="title function_ invoke__">transaction</span>(|tree| &#123;</span><br><span class="line">    tree.<span class="title function_ invoke__">insert</span>(<span class="string">&quot;key1&quot;</span>, <span class="string">&quot;value1&quot;</span>)?;</span><br><span class="line">    tree.<span class="title function_ invoke__">insert</span>(<span class="string">&quot;key2&quot;</span>, <span class="string">&quot;value2&quot;</span>)?;</span><br><span class="line">    <span class="title function_ invoke__">Ok</span>(())</span><br><span class="line">&#125;)?;</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">ä»‹ç»Rustç”Ÿæ€ä¸­çš„åµŒå…¥å¼é”®å€¼æ•°æ®åº“Sledï¼ŒåŒ…æ‹¬å…¶åŸºæœ¬æ¦‚å¿µã€ç‰¹æ€§ä»¥åŠå¸¸ç”¨æ“ä½œæ–¹æ³•</summary>
    
    
    
    <category term="åç«¯å¼€å‘" scheme="https://eatbreads.github.io/categories/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/"/>
    
    
    <category term="æ•°æ®åº“" scheme="https://eatbreads.github.io/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/"/>
    
    <category term="Rust" scheme="https://eatbreads.github.io/tags/Rust/"/>
    
    <category term="åµŒå…¥å¼" scheme="https://eatbreads.github.io/tags/%E5%B5%8C%E5%85%A5%E5%BC%8F/"/>
    
  </entry>
  
  <entry>
    <title>GitHub READMEä¸­çš„ä¾¿æ·è·³è½¬åŠŸèƒ½ä»‹ç»</title>
    <link href="https://eatbreads.github.io/posts/e16aa73e.html"/>
    <id>https://eatbreads.github.io/posts/e16aa73e.html</id>
    <published>2025-04-26T14:22:30.000Z</published>
    <updated>2025-04-26T14:24:04.213Z</updated>
    
    <content type="html"><![CDATA[<h1>GitHub READMEä¸­çš„ä¾¿æ·è·³è½¬åŠŸèƒ½</h1><p>åœ¨GitHubé¡¹ç›®å¼€å‘ä¸­ï¼ŒREADMEæ–‡ä»¶ä¸ä»…ä»…æ˜¯é¡¹ç›®çš„è¯´æ˜ä¹¦ï¼Œè¿˜å¯ä»¥ä½œä¸ºé¡¹ç›®å¼€å‘å†ç¨‹çš„å¯¼èˆªã€‚æœ¬æ–‡å°†ä»‹ç»å¦‚ä½•åœ¨READMEä¸­å®ç°ä¾¿æ·çš„ä»£ç ç‰ˆæœ¬è·³è½¬åŠŸèƒ½ã€‚</p><h2 id="åŸºæœ¬è¯­æ³•">åŸºæœ¬è¯­æ³•</h2><h3 id="1-åˆ†æ”¯è·³è½¬">1. åˆ†æ”¯è·³è½¬</h3><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[<span class="string">åˆ†æ”¯åç§°</span>](<span class="link">https://github.com/ç”¨æˆ·å/ä»“åº“å/tree/åˆ†æ”¯å</span>)</span><br></pre></td></tr></table></figure><p>ç¤ºä¾‹ï¼š</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[<span class="string">åˆå§‹æäº¤</span>](<span class="link">https://github.com/eatbreads/bitcoin_demo/tree/initial</span>)</span><br></pre></td></tr></table></figure><h3 id="2-ç‰¹å®šcommitè·³è½¬">2. ç‰¹å®šcommitè·³è½¬</h3><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[<span class="string">commitæè¿°</span>](<span class="link">https://github.com/ç”¨æˆ·å/ä»“åº“å/tree/commitå“ˆå¸Œ</span>)</span><br></pre></td></tr></table></figure><p>ç¤ºä¾‹ï¼š</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[<span class="string">commit eb822486</span>](<span class="link">https://github.com/eatbreads/bitcoin_demo/tree/eb822486</span>)</span><br></pre></td></tr></table></figure><h2 id="å®é™…åº”ç”¨ç¤ºä¾‹">å®é™…åº”ç”¨ç¤ºä¾‹</h2><p>ä»¥ä¸‹æ˜¯ä¸€ä¸ªåŒºå—é“¾é¡¹ç›®çš„å¼€å‘é˜¶æ®µè¯´æ˜ï¼š</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">## å¼€å‘é˜¶æ®µ</span></span><br><span class="line"></span><br><span class="line"><span class="bullet">1.</span> part1: Basic Prototype <span class="code">`åŸºæœ¬åŸå‹`</span>              </span><br><span class="line">   [<span class="string">åˆå§‹æäº¤</span>](<span class="link">https://github.com/eatbreads/bitcoin_demo/tree/initial</span>)</span><br><span class="line"><span class="bullet">   -</span> å®ç°åŒºå—ç»“æ„</span><br><span class="line"><span class="bullet">   -</span> å®ç°åŸºç¡€åŒºå—é“¾</span><br><span class="line"><span class="bullet">   -</span> åˆ›ä¸–åŒºå—ç”Ÿæˆ</span><br><span class="line"></span><br><span class="line"><span class="bullet">2.</span> part2: Proof-of-Work <span class="code">`å·¥ä½œé‡è¯æ˜`</span>            </span><br><span class="line">   [<span class="string">commit eb822486</span>](<span class="link">https://github.com/eatbreads/bitcoin_demo/tree/eb822486</span>)</span><br><span class="line"><span class="bullet">   -</span> å®ç°å·¥ä½œé‡è¯æ˜ç®—æ³•</span><br><span class="line"><span class="bullet">   -</span> æ·»åŠ æŒ–çŸ¿åŠŸèƒ½</span><br><span class="line"><span class="bullet">   -</span> åŒºå—å“ˆå¸Œè®¡ç®—</span><br><span class="line"></span><br><span class="line"><span class="bullet">3.</span> part3: Persistence and CLI <span class="code">`æŒä¹…åŒ–å’Œå‘½ä»¤è¡Œ`</span>  </span><br><span class="line">   [<span class="string">commit 8880dd2</span>](<span class="link">https://github.com/eatbreads/bitcoin_demo/tree/8880dd2</span>)</span><br><span class="line"><span class="bullet">   -</span> ä½¿ç”¨ sled å®ç°æ•°æ®æŒä¹…åŒ–</span><br><span class="line"><span class="bullet">   -</span> æ·»åŠ å‘½ä»¤è¡Œäº¤äº’ç•Œé¢</span><br><span class="line"><span class="bullet">   -</span> å®ç°åŒºå—é“¾éå†åŠŸèƒ½</span><br></pre></td></tr></table></figure><h2 id="ä½¿ç”¨æŠ€å·§">ä½¿ç”¨æŠ€å·§</h2><ol><li><p><strong>ç‰ˆæœ¬æ ‡è®°</strong></p><ul><li>é‡è¦åŠŸèƒ½å®ŒæˆååŠæ—¶åˆ›å»ºtagæˆ–åˆ†æ”¯</li><li>ä½¿ç”¨æœ‰æ„ä¹‰çš„commit message</li><li>è®°å½•å…³é”®commitçš„å“ˆå¸Œå€¼</li></ul></li><li><p><strong>READMEç»„ç»‡</strong></p><ul><li>æŒ‰å¼€å‘é˜¶æ®µåˆ’åˆ†ç« èŠ‚</li><li>æ¯ä¸ªé˜¶æ®µæ ‡æ³¨å¯¹åº”çš„åˆ†æ”¯æˆ–commit</li><li>åˆ—å‡ºè¯¥é˜¶æ®µçš„ä¸»è¦åŠŸèƒ½ç‚¹</li></ul></li><li><p><strong>é“¾æ¥ç®¡ç†</strong></p><ul><li>ä½¿ç”¨ç›¸å¯¹è·¯å¾„è€Œéå®Œæ•´URL</li><li>ä¿æŒé“¾æ¥æ ¼å¼ç»Ÿä¸€</li><li>å®šæœŸæ£€æŸ¥é“¾æ¥æœ‰æ•ˆæ€§</li></ul></li></ol><p>è¿™ç§è·³è½¬åŠŸèƒ½ä¸ä»…æ–¹ä¾¿äº†é¡¹ç›®çš„ç®¡ç†å’Œç»´æŠ¤ï¼Œä¹Ÿä¸ºå…¶ä»–å¼€å‘è€…å­¦ä¹ å’Œå‚è€ƒé¡¹ç›®æä¾›äº†æ¸…æ™°çš„è·¯å¾„æŒ‡å¼•ã€‚</p>]]></content>
    
    
    <summary type="html">ä»‹ç»å¦‚ä½•åœ¨GitHubçš„READMEä¸­å®ç°ä¾¿æ·çš„ä»£ç ç‰ˆæœ¬è·³è½¬ï¼ŒåŒ…æ‹¬åˆ†æ”¯è·³è½¬å’Œcommitå“ˆå¸Œè·³è½¬ç­‰åŠŸèƒ½</summary>
    
    
    
    <category term="å¼€å‘æŠ€å·§" scheme="https://eatbreads.github.io/categories/%E5%BC%80%E5%8F%91%E6%8A%80%E5%B7%A7/"/>
    
    
    <category term="GitHub" scheme="https://eatbreads.github.io/tags/GitHub/"/>
    
    <category term="Markdown" scheme="https://eatbreads.github.io/tags/Markdown/"/>
    
    <category term="å¼€å‘å·¥å…·" scheme="https://eatbreads.github.io/tags/%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/"/>
    
  </entry>
  
  <entry>
    <title>æ¯”ç‰¹å¸ç®€æ˜“å®ç°ä»£ç (ä¸‰)ï¼šäº¤æ˜“ç³»ç»Ÿä¸ä½™é¢æŸ¥è¯¢</title>
    <link href="https://eatbreads.github.io/posts/ea2afd4d.html"/>
    <id>https://eatbreads.github.io/posts/ea2afd4d.html</id>
    <published>2025-04-24T15:27:12.000Z</published>
    <updated>2025-04-24T15:36:47.759Z</updated>
    
    <content type="html"><![CDATA[<h1>æ¯”ç‰¹å¸äº¤æ˜“ç³»ç»Ÿå®ç°</h1><h2 id="æ ¸å¿ƒæ•°æ®ç»“æ„">æ ¸å¿ƒæ•°æ®ç»“æ„</h2><h3 id="1-äº¤æ˜“ç»“æ„">1. äº¤æ˜“ç»“æ„</h3><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">Transaction</span> &#123;</span><br><span class="line">    id: <span class="type">String</span>,</span><br><span class="line">    vin: <span class="type">Vec</span>&lt;TXInput&gt;,</span><br><span class="line">    vout: <span class="type">Vec</span>&lt;TXOutput&gt;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="2-äº¤æ˜“è¾“å‡º-TXOutput">2. äº¤æ˜“è¾“å‡º(TXOutput)</h3><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">TXOutput</span> &#123;</span><br><span class="line">    value: <span class="type">i64</span>,        <span class="comment">// ä»¥satoshiä¸ºå•ä½</span></span><br><span class="line">    script_pub_key: <span class="type">String</span>,  <span class="comment">// é”å®šè„šæœ¬(æ¥æ”¶æ–¹åœ°å€/å…¬é’¥)</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>è¯´æ˜ï¼š</p><ul><li>valueè¡¨ç¤ºä»£é‡‘åˆ¸é‡‘é¢</li><li>script_pub_keyå®šä¹‰ä½¿ç”¨è§„åˆ™</li></ul></blockquote><h3 id="3-äº¤æ˜“è¾“å…¥-TXInput">3. äº¤æ˜“è¾“å…¥(TXInput)</h3><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">TXInput</span> &#123;</span><br><span class="line">    txid: <span class="type">String</span>,      <span class="comment">// å¼•ç”¨çš„äº¤æ˜“ID</span></span><br><span class="line">    vout: <span class="type">i32</span>,         <span class="comment">// è¾“å‡ºç´¢å¼•</span></span><br><span class="line">    script_sig: <span class="type">String</span>, <span class="comment">// è§£é”è„šæœ¬</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>è¯´æ˜ï¼š</p><ul><li>voutæŒ‡æ˜ä½¿ç”¨å“ªä¸ªè¾“å‡ºä½œä¸ºæœ¬æ¬¡è¾“å…¥</li><li>æœªè¢«å¼•ç”¨çš„è¾“å‡ºå³ä¸ºä½™é¢</li></ul></blockquote><h2 id="åŠŸèƒ½å®ç°">åŠŸèƒ½å®ç°</h2><h3 id="1-åˆ›ä¸–äº¤æ˜“">1. åˆ›ä¸–äº¤æ˜“</h3><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">impl</span> <span class="title class_">Transaction</span> &#123;</span><br><span class="line">    <span class="keyword">fn</span> <span class="title function_">new_coinbase</span>(to: <span class="type">String</span>, data: <span class="type">String</span>) <span class="punctuation">-&gt;</span> <span class="keyword">Self</span> &#123;</span><br><span class="line">        Transaction &#123;</span><br><span class="line">            id: <span class="type">String</span>::<span class="title function_ invoke__">new</span>(),</span><br><span class="line">            vin: <span class="built_in">vec!</span>[TXInput &#123;</span><br><span class="line">                txid: <span class="type">String</span>::<span class="title function_ invoke__">new</span>(),</span><br><span class="line">                vout: -<span class="number">1</span>,</span><br><span class="line">                script_sig: data,</span><br><span class="line">            &#125;],</span><br><span class="line">            vout: <span class="built_in">vec!</span>[TXOutput &#123;</span><br><span class="line">                value: <span class="number">50</span> * <span class="number">100_000_000</span>, <span class="comment">// 50 BTC</span></span><br><span class="line">                script_pub_key: to,</span><br><span class="line">            &#125;],</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="2-ä½™é¢æŸ¥è¯¢å®ç°">2. ä½™é¢æŸ¥è¯¢å®ç°</h3><h4 id="æŸ¥æ‰¾æœªèŠ±è´¹äº¤æ˜“">æŸ¥æ‰¾æœªèŠ±è´¹äº¤æ˜“</h4><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">impl</span> <span class="title class_">Blockchain</span> &#123;</span><br><span class="line">    <span class="keyword">fn</span> <span class="title function_">find_unspent_transactions</span>(&amp;<span class="keyword">self</span>, address: &amp;<span class="type">str</span>) <span class="punctuation">-&gt;</span> <span class="type">Vec</span>&lt;Transaction&gt; &#123;</span><br><span class="line">        <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">unspent_txs</span> = <span class="type">Vec</span>::<span class="title function_ invoke__">new</span>();</span><br><span class="line">        <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">spent_outputs</span> = HashMap::<span class="title function_ invoke__">new</span>();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> <span class="variable">block</span> <span class="keyword">in</span> <span class="keyword">self</span>.<span class="title function_ invoke__">iter</span>() &#123;</span><br><span class="line">            <span class="keyword">for</span> <span class="variable">tx</span> <span class="keyword">in</span> block.transactions &#123;</span><br><span class="line">                <span class="comment">// è®°å½•å·²èŠ±è´¹è¾“å‡º</span></span><br><span class="line">                <span class="keyword">for</span> <span class="variable">input</span> <span class="keyword">in</span> &amp;tx.vin &#123;</span><br><span class="line">                    <span class="keyword">if</span> input.<span class="title function_ invoke__">can_unlock_output_with</span>(address) &#123;</span><br><span class="line">                        spent_outputs.<span class="title function_ invoke__">insert</span>((input.txid.<span class="title function_ invoke__">clone</span>(), input.vout));</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                <span class="comment">// æŸ¥æ‰¾æœªèŠ±è´¹è¾“å‡º</span></span><br><span class="line">                <span class="keyword">for</span> (i, output) <span class="keyword">in</span> tx.vout.<span class="title function_ invoke__">iter</span>().<span class="title function_ invoke__">enumerate</span>() &#123;</span><br><span class="line">                    <span class="keyword">if</span> !spent_outputs.<span class="title function_ invoke__">contains_key</span>(&amp;(tx.id.<span class="title function_ invoke__">clone</span>(), i <span class="keyword">as</span> <span class="type">i32</span>))</span><br><span class="line">                        &amp;&amp; output.<span class="title function_ invoke__">can_be_unlocked_with</span>(address) &#123;</span><br><span class="line">                        unspent_txs.<span class="title function_ invoke__">push</span>(tx.<span class="title function_ invoke__">clone</span>());</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        unspent_txs</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="è®¡ç®—ä½™é¢">è®¡ç®—ä½™é¢</h4><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">impl</span> <span class="title class_">Blockchain</span> &#123;</span><br><span class="line">    <span class="keyword">fn</span> <span class="title function_">get_balance</span>(&amp;<span class="keyword">self</span>, address: &amp;<span class="type">str</span>) <span class="punctuation">-&gt;</span> <span class="type">i64</span> &#123;</span><br><span class="line">        <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">balance</span> = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">let</span> <span class="variable">utxos</span> = <span class="keyword">self</span>.<span class="title function_ invoke__">find_unspent_transactions</span>(address);</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">for</span> <span class="variable">tx</span> <span class="keyword">in</span> utxos &#123;</span><br><span class="line">            <span class="keyword">for</span> <span class="variable">output</span> <span class="keyword">in</span> tx.vout &#123;</span><br><span class="line">                <span class="keyword">if</span> output.<span class="title function_ invoke__">can_be_unlocked_with</span>(address) &#123;</span><br><span class="line">                    balance += output.value;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        balance</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="ä½™é¢æŸ¥è¯¢æµç¨‹">ä½™é¢æŸ¥è¯¢æµç¨‹</h2><p><img src="https://cdn-a.markji.com/files/6809e95d6092fd692c50f89a_hd.png?e=1745509881827&amp;token=xX63b9jqTlDOcGmctt5K9254rV0LG8hS9BmDeFBy:NhrH-qO9mCnJGszcenPcMuhyC5I=" alt="å›¾ç‰‡1"></p><h3 id="1-åˆå§‹åŒ–">1. åˆå§‹åŒ–</h3><ul><li>åˆ›å»ºæœªèŠ±è´¹äº¤æ˜“åˆ‡ç‰‡</li><li>åˆ›å»ºå·²èŠ±è´¹è¾“å‡ºæ˜ å°„</li></ul><h3 id="2-éå†åŒºå—é“¾">2. éå†åŒºå—é“¾</h3><ul><li>è·å–åŒºå—é“¾è¿­ä»£å™¨</li><li>éå†æ¯ä¸ªåŒºå—ç›´åˆ°åˆ›ä¸–å—</li></ul><h3 id="3-å¤„ç†äº¤æ˜“">3. å¤„ç†äº¤æ˜“</h3><ul><li>éå†åŒºå—ä¸­æ‰€æœ‰äº¤æ˜“</li><li>è®°å½•å·²èŠ±è´¹è¾“å‡º</li><li>æŸ¥æ‰¾æœªèŠ±è´¹è¾“å‡º</li></ul><h3 id="4-éªŒè¯æ‰€æœ‰æƒ">4. éªŒè¯æ‰€æœ‰æƒ</h3><ul><li>æ£€æŸ¥è¾“å‡ºæ˜¯å¦èƒ½è¢«åœ°å€è§£é”</li><li>ç¡®è®¤è¾“å‡ºæœªè¢«åç»­äº¤æ˜“èŠ±è´¹</li></ul><h3 id="5-è®¡ç®—æœ€ç»ˆä½™é¢">5. è®¡ç®—æœ€ç»ˆä½™é¢</h3><ul><li>ç´¯åŠ æ‰€æœ‰æœªèŠ±è´¹è¾“å‡ºçš„å€¼</li><li>è¿”å›æ€»ä½™é¢</li></ul><h2 id="å®ç°ç‰¹ç‚¹">å®ç°ç‰¹ç‚¹</h2><ol><li>é‡‡ç”¨UTXOæ¨¡å‹</li><li>æ”¯æŒå¤šè¾“å…¥å¤šè¾“å‡º</li><li>å®ç°åŸºç¡€è„šæœ¬ç³»ç»Ÿ</li><li>æä¾›ä½™é¢æŸ¥è¯¢åŠŸèƒ½</li><li>æ”¯æŒæ–°äº¤æ˜“åˆ›å»º</li></ol>]]></content>
    
    
    <summary type="html">å®ç°æ¯”ç‰¹å¸çš„äº¤æ˜“ç³»ç»Ÿå’Œä½™é¢æŸ¥è¯¢åŠŸèƒ½ï¼ŒåŒ…æ‹¬äº¤æ˜“ç»“æ„è®¾è®¡ã€UTXOæ¨¡å‹å’Œä½™é¢è®¡ç®—</summary>
    
    
    
    <category term="åŒºå—é“¾æŠ€æœ¯" scheme="https://eatbreads.github.io/categories/%E5%8C%BA%E5%9D%97%E9%93%BE%E6%8A%80%E6%9C%AF/"/>
    
    
    <category term="åŒºå—é“¾" scheme="https://eatbreads.github.io/tags/%E5%8C%BA%E5%9D%97%E9%93%BE/"/>
    
    <category term="Rust" scheme="https://eatbreads.github.io/tags/Rust/"/>
    
    <category term="æ¯”ç‰¹å¸" scheme="https://eatbreads.github.io/tags/%E6%AF%94%E7%89%B9%E5%B8%81/"/>
    
  </entry>
  
  <entry>
    <title>æ¯”ç‰¹å¸ç®€æ˜“å®ç°ä»£ç (ä¸€)ï¼šåŸºç¡€ç»“æ„</title>
    <link href="https://eatbreads.github.io/posts/460941b6.html"/>
    <id>https://eatbreads.github.io/posts/460941b6.html</id>
    <published>2025-04-23T15:40:50.000Z</published>
    <updated>2025-04-23T15:43:58.533Z</updated>
    
    <content type="html"><![CDATA[<h1 id="æ¯”ç‰¹å¸æ ¸å¿ƒç»“æ„å®ç°"><a href="#æ¯”ç‰¹å¸æ ¸å¿ƒç»“æ„å®ç°" class="headerlink" title="æ¯”ç‰¹å¸æ ¸å¿ƒç»“æ„å®ç°"></a>æ¯”ç‰¹å¸æ ¸å¿ƒç»“æ„å®ç°</h1><h3 id="1-åŒºå—ç»“æ„è®¾è®¡"><a href="#1-åŒºå—ç»“æ„è®¾è®¡" class="headerlink" title="1. åŒºå—ç»“æ„è®¾è®¡"></a>1. åŒºå—ç»“æ„è®¾è®¡</h3><ul><li>å®šä¹‰Blockç»“æ„ä½“ï¼ŒåŒ…å«æ—¶é—´æˆ³ã€å‰å“ˆå¸Œã€æ•°æ®å’Œå½“å‰å“ˆå¸Œ</li><li>å®ç°è®¡ç®—å½“å‰å“ˆå¸Œçš„æ–¹æ³•</li></ul><h3 id="2-åŒºå—é“¾è®¾è®¡"><a href="#2-åŒºå—é“¾è®¾è®¡" class="headerlink" title="2. åŒºå—é“¾è®¾è®¡"></a>2. åŒºå—é“¾è®¾è®¡</h3><ul><li>å®šä¹‰Blockchainç»“æ„ä½“ï¼ŒåŒ…å«åŒºå—æ•°ç»„</li><li>å®ç°æ·»åŠ åŒºå—çš„æ–¹æ³•</li><li>å®ç°åˆ›ä¸–å—ç”ŸæˆåŠŸèƒ½</li></ul><h3 id="3-å·¥ä½œé‡è¯æ˜æœºåˆ¶"><a href="#3-å·¥ä½œé‡è¯æ˜æœºåˆ¶" class="headerlink" title="3. å·¥ä½œé‡è¯æ˜æœºåˆ¶"></a>3. å·¥ä½œé‡è¯æ˜æœºåˆ¶</h3><ul><li>å®šä¹‰ProofOfWorkç»“æ„ä½“ï¼ŒåŒ…å«åŒºå—å¼•ç”¨å’Œç›®æ ‡å€¼</li><li>å®ç°æ„é€ å‡½æ•°ï¼Œè®¾ç½®éš¾åº¦ç›®æ ‡</li><li>å®ç°æ•°æ®å‡†å¤‡æ–¹æ³•</li><li>å®ç°æŒ–çŸ¿è¿è¡Œæ–¹æ³•</li><li>å®ç°æœ‰æ•ˆæ€§éªŒè¯</li></ul><p>9.ä¿®æ”¹addblockå‡½æ•°,åœ¨å…¶ä¸­è°ƒç”¨å·¥ä½œé‡è¯æ˜,runæˆåŠŸäº†æ‰æ‰§è¡Œæ·»åŠ </p><p>10.å®šä¹‰ç¡®è®¤åŒºå—æœ‰æ•ˆåŒºå—,ç¡®è®¤ä¸€ä¸‹ä¹‹å‰Runä¸æ˜¯å› ä¸ºæº¢å‡ºè€Œç»“æŸ</p><h2 id="åŸºç¡€æ•°æ®ç»“æ„"><a href="#åŸºç¡€æ•°æ®ç»“æ„" class="headerlink" title="åŸºç¡€æ•°æ®ç»“æ„"></a>åŸºç¡€æ•°æ®ç»“æ„</h2><h3 id="åŒºå—ç»“æ„"><a href="#åŒºå—ç»“æ„" class="headerlink" title="åŒºå—ç»“æ„"></a>åŒºå—ç»“æ„</h3><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">use</span> chrono::Utc;</span><br><span class="line"><span class="keyword">use</span> sha2::&#123;Sha256, Digest&#125;;</span><br><span class="line"></span><br><span class="line"><span class="meta">#[derive(Debug)]</span></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Block</span> &#123;</span><br><span class="line">    timestamp: <span class="type">i64</span>,</span><br><span class="line">    prev_hash: <span class="type">String</span>,</span><br><span class="line">    hash: <span class="type">String</span>,</span><br><span class="line">    data: <span class="type">String</span>,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">impl</span> <span class="title class_">Block</span> &#123;</span><br><span class="line">    <span class="keyword">fn</span> <span class="title function_">calculate_hash</span>(&amp;<span class="keyword">self</span>) <span class="punctuation">-&gt;</span> <span class="type">String</span> &#123;</span><br><span class="line">        <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">hasher</span> = Sha256::<span class="title function_ invoke__">new</span>();</span><br><span class="line">        <span class="keyword">let</span> <span class="variable">data</span> = <span class="built_in">format!</span>(<span class="string">&quot;&#123;&#125;&#123;&#125;&#123;&#125;&quot;</span>, <span class="keyword">self</span>.timestamp, <span class="keyword">self</span>.prev_hash, <span class="keyword">self</span>.data);</span><br><span class="line">        hasher.<span class="title function_ invoke__">update</span>(data);</span><br><span class="line">        <span class="built_in">format!</span>(<span class="string">&quot;&#123;:x&#125;&quot;</span>, hasher.<span class="title function_ invoke__">finalize</span>())</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="åŒºå—é“¾ç»“æ„"><a href="#åŒºå—é“¾ç»“æ„" class="headerlink" title="åŒºå—é“¾ç»“æ„"></a>åŒºå—é“¾ç»“æ„</h3><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#[derive(Debug)]</span></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Blockchain</span> &#123;</span><br><span class="line">    blocks: <span class="type">Vec</span>&lt;Block&gt;,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">impl</span> <span class="title class_">Blockchain</span> &#123;</span><br><span class="line">    <span class="keyword">fn</span> <span class="title function_">new</span>() <span class="punctuation">-&gt;</span> <span class="keyword">Self</span> &#123;</span><br><span class="line">        <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">chain</span> = Blockchain &#123;</span><br><span class="line">            blocks: <span class="type">Vec</span>::<span class="title function_ invoke__">new</span>(),</span><br><span class="line">        &#125;;</span><br><span class="line">        chain.<span class="title function_ invoke__">create_genesis_block</span>();</span><br><span class="line">        chain</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">fn</span> <span class="title function_">create_genesis_block</span>(&amp;<span class="keyword">mut</span> <span class="keyword">self</span>) &#123;</span><br><span class="line">        <span class="keyword">let</span> <span class="variable">genesis</span> = Block &#123;</span><br><span class="line">            timestamp: Utc::<span class="title function_ invoke__">now</span>().<span class="title function_ invoke__">timestamp</span>(),</span><br><span class="line">            prev_hash: <span class="type">String</span>::<span class="title function_ invoke__">from</span>(<span class="string">&quot;0&quot;</span>),</span><br><span class="line">            data: <span class="type">String</span>::<span class="title function_ invoke__">from</span>(<span class="string">&quot;Genesis Block&quot;</span>),</span><br><span class="line">            hash: <span class="type">String</span>::<span class="title function_ invoke__">new</span>(),</span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="keyword">let</span> <span class="variable">hash</span> = genesis.<span class="title function_ invoke__">calculate_hash</span>();</span><br><span class="line">        <span class="keyword">self</span>.blocks.<span class="title function_ invoke__">push</span>(Block &#123;</span><br><span class="line">            hash,</span><br><span class="line">            ..genesis</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="å·¥ä½œé‡è¯æ˜å®ç°"><a href="#å·¥ä½œé‡è¯æ˜å®ç°" class="headerlink" title="å·¥ä½œé‡è¯æ˜å®ç°"></a>å·¥ä½œé‡è¯æ˜å®ç°</h2><h3 id="PoWç»“æ„"><a href="#PoWç»“æ„" class="headerlink" title="PoWç»“æ„"></a>PoWç»“æ„</h3><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">ProofOfWork</span>&lt;<span class="symbol">&#x27;a</span>&gt; &#123;</span><br><span class="line">    block: &amp;<span class="symbol">&#x27;a</span> Block,</span><br><span class="line">    target: <span class="type">String</span>,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">impl</span>&lt;<span class="symbol">&#x27;a</span>&gt; ProofOfWork&lt;<span class="symbol">&#x27;a</span>&gt; &#123;</span><br><span class="line">    <span class="keyword">fn</span> <span class="title function_">new</span>(block: &amp;<span class="symbol">&#x27;a</span> Block) <span class="punctuation">-&gt;</span> <span class="keyword">Self</span> &#123;</span><br><span class="line">        <span class="comment">// è®¾ç½®éš¾åº¦ç›®æ ‡ï¼šå‰5ä½ä¸º0</span></span><br><span class="line">        <span class="keyword">let</span> <span class="variable">target</span> = <span class="string">&quot;00000&quot;</span>.<span class="title function_ invoke__">to_string</span>() + &amp;<span class="string">&quot;f&quot;</span>.<span class="title function_ invoke__">repeat</span>(<span class="number">59</span>);</span><br><span class="line">        ProofOfWork &#123; block, target &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">fn</span> <span class="title function_">prepare_data</span>(&amp;<span class="keyword">self</span>, nonce: <span class="type">i64</span>) <span class="punctuation">-&gt;</span> <span class="type">String</span> &#123;</span><br><span class="line">        <span class="built_in">format!</span>(</span><br><span class="line">            <span class="string">&quot;&#123;&#125;&#123;&#125;&#123;&#125;&#123;&#125;&quot;</span>,</span><br><span class="line">            <span class="keyword">self</span>.block.timestamp,</span><br><span class="line">            <span class="keyword">self</span>.block.prev_hash,</span><br><span class="line">            <span class="keyword">self</span>.block.data,</span><br><span class="line">            nonce</span><br><span class="line">        )</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">fn</span> <span class="title function_">run</span>(&amp;<span class="keyword">self</span>) <span class="punctuation">-&gt;</span> (<span class="type">i64</span>, <span class="type">String</span>) &#123;</span><br><span class="line">        <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">nonce</span> = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">let</span> <span class="variable">max_nonce</span> = <span class="type">i64</span>::MAX;</span><br><span class="line">        <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">hash</span> = <span class="type">String</span>::<span class="title function_ invoke__">new</span>();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span> nonce &lt; max_nonce &#123;</span><br><span class="line">            <span class="keyword">let</span> <span class="variable">data</span> = <span class="keyword">self</span>.<span class="title function_ invoke__">prepare_data</span>(nonce);</span><br><span class="line">            <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">hasher</span> = Sha256::<span class="title function_ invoke__">new</span>();</span><br><span class="line">            hasher.<span class="title function_ invoke__">update</span>(data);</span><br><span class="line">            hash = <span class="built_in">format!</span>(<span class="string">&quot;&#123;:x&#125;&quot;</span>, hasher.<span class="title function_ invoke__">finalize</span>());</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> hash &lt; <span class="keyword">self</span>.target &#123;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            nonce += <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        (nonce, hash)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">fn</span> <span class="title function_">validate</span>(&amp;<span class="keyword">self</span>, nonce: <span class="type">i64</span>) <span class="punctuation">-&gt;</span> <span class="type">bool</span> &#123;</span><br><span class="line">        <span class="keyword">let</span> <span class="variable">data</span> = <span class="keyword">self</span>.<span class="title function_ invoke__">prepare_data</span>(nonce);</span><br><span class="line">        <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">hasher</span> = Sha256::<span class="title function_ invoke__">new</span>();</span><br><span class="line">        hasher.<span class="title function_ invoke__">update</span>(data);</span><br><span class="line">        <span class="keyword">let</span> <span class="variable">hash</span> = <span class="built_in">format!</span>(<span class="string">&quot;&#123;:x&#125;&quot;</span>, hasher.<span class="title function_ invoke__">finalize</span>());</span><br><span class="line">        hash &lt; <span class="keyword">self</span>.target</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="æ·»åŠ æ–°åŒºå—"><a href="#æ·»åŠ æ–°åŒºå—" class="headerlink" title="æ·»åŠ æ–°åŒºå—"></a>æ·»åŠ æ–°åŒºå—</h3><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">impl</span> <span class="title class_">Blockchain</span> &#123;</span><br><span class="line">    <span class="keyword">fn</span> <span class="title function_">add_block</span>(&amp;<span class="keyword">mut</span> <span class="keyword">self</span>, data: <span class="type">String</span>) &#123;</span><br><span class="line">        <span class="keyword">let</span> <span class="variable">prev_block</span> = <span class="keyword">self</span>.blocks.<span class="title function_ invoke__">last</span>().<span class="title function_ invoke__">unwrap</span>();</span><br><span class="line">        <span class="keyword">let</span> <span class="variable">new_block</span> = Block &#123;</span><br><span class="line">            timestamp: Utc::<span class="title function_ invoke__">now</span>().<span class="title function_ invoke__">timestamp</span>(),</span><br><span class="line">            prev_hash: prev_block.hash.<span class="title function_ invoke__">clone</span>(),</span><br><span class="line">            data,</span><br><span class="line">            hash: <span class="type">String</span>::<span class="title function_ invoke__">new</span>(),</span><br><span class="line">        &#125;;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">let</span> <span class="variable">pow</span> = ProofOfWork::<span class="title function_ invoke__">new</span>(&amp;new_block);</span><br><span class="line">        <span class="keyword">let</span> (nonce, hash) = pow.<span class="title function_ invoke__">run</span>();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> pow.<span class="title function_ invoke__">validate</span>(nonce) &#123;</span><br><span class="line">            <span class="keyword">self</span>.blocks.<span class="title function_ invoke__">push</span>(Block &#123;</span><br><span class="line">                hash,</span><br><span class="line">                ..new_block</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªå®ç°ï¼š</p><ol><li>ä½¿ç”¨Rustçš„ç±»å‹ç³»ç»Ÿç¡®ä¿å†…å­˜å®‰å…¨</li><li>é‡‡ç”¨traitå®ç°æ›´å¥½çš„ä»£ç ç»„ç»‡</li><li>ä½¿ç”¨chronoå¤„ç†æ—¶é—´æˆ³</li><li>ä½¿ç”¨sha2è¿›è¡Œå“ˆå¸Œè®¡ç®—</li><li>æ‰€æœ‰å­—ç¬¦ä¸²é‡‡ç”¨Stringç±»å‹ï¼Œé¿å…å­—ç¬¦ä¸²åˆ‡ç‰‡çš„ç”Ÿå‘½å‘¨æœŸé—®é¢˜</li></ol><p>è¦ä½¿ç”¨è¿™æ®µä»£ç ï¼Œéœ€è¦åœ¨Cargo.tomlä¸­æ·»åŠ ä»¥ä¸‹ä¾èµ–ï¼š<br><figure class="highlight toml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">[dependencies]</span></span><br><span class="line"><span class="attr">chrono</span> = <span class="string">&quot;0.4&quot;</span></span><br><span class="line"><span class="attr">sha2</span> = <span class="string">&quot;0.10&quot;</span></span><br></pre></td></tr></table></figure></p>]]></content>
    
    
    <summary type="html">ä½¿ç”¨Rustå®ç°æ¯”ç‰¹å¸çš„åŸºç¡€ç»“æ„ï¼ŒåŒ…æ‹¬åŒºå—ã€åŒºå—é“¾ã€å·¥ä½œé‡è¯æ˜ç­‰æ ¸å¿ƒæ¦‚å¿µçš„ä»£ç å®ç°</summary>
    
    
    
    <category term="åŒºå—é“¾æŠ€æœ¯" scheme="https://eatbreads.github.io/categories/%E5%8C%BA%E5%9D%97%E9%93%BE%E6%8A%80%E6%9C%AF/"/>
    
    
    <category term="åŒºå—é“¾" scheme="https://eatbreads.github.io/tags/%E5%8C%BA%E5%9D%97%E9%93%BE/"/>
    
    <category term="Rust" scheme="https://eatbreads.github.io/tags/Rust/"/>
    
    <category term="æ¯”ç‰¹å¸" scheme="https://eatbreads.github.io/tags/%E6%AF%94%E7%89%B9%E5%B8%81/"/>
    
  </entry>
  
  <entry>
    <title>åŒºå—é“¾ä¸æ¯”ç‰¹å¸åŸç†ç®€è¿°</title>
    <link href="https://eatbreads.github.io/posts/3fc00ad7.html"/>
    <id>https://eatbreads.github.io/posts/3fc00ad7.html</id>
    <published>2025-04-23T15:38:12.000Z</published>
    <updated>2025-04-23T15:43:58.536Z</updated>
    
    <content type="html"><![CDATA[<h1 id="åŒºå—é“¾åŸºç¡€çŸ¥è¯†"><a href="#åŒºå—é“¾åŸºç¡€çŸ¥è¯†" class="headerlink" title="åŒºå—é“¾åŸºç¡€çŸ¥è¯†"></a>åŒºå—é“¾åŸºç¡€çŸ¥è¯†</h1><h2 id="åŒºå—ç»“æ„"><a href="#åŒºå—ç»“æ„" class="headerlink" title="åŒºå—ç»“æ„"></a>åŒºå—ç»“æ„</h2><p>ç®€æ˜“ç‰ˆåŒºå—åŒ…å«ä»¥ä¸‹å†…å®¹ï¼š</p><ul><li>æ—¶é—´æˆ³</li><li>å‰å“ˆå¸Œ</li><li>å½“å‰å“ˆå¸Œ</li><li>å®é™…dataï¼ˆäº¤æ˜“ä¿¡æ¯ï¼‰</li></ul><h3 id="å“ˆå¸Œè®¡ç®—"><a href="#å“ˆå¸Œè®¡ç®—" class="headerlink" title="å“ˆå¸Œè®¡ç®—"></a>å“ˆå¸Œè®¡ç®—</h3><p>å½“å‰å“ˆå¸Œçš„è®¡ç®—æ–¹æ³•ï¼š<br><figure class="highlight haskell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">å½“å‰å“ˆå¸Œ = <span class="type">SHA256</span>(æ—¶é—´æˆ³ + å‰å“ˆå¸Œ + å®é™…<span class="class"><span class="keyword">data</span>)</span></span><br></pre></td></tr></table></figure></p><h3 id="æœ¬è´¨ç‰¹å¾"><a href="#æœ¬è´¨ç‰¹å¾" class="headerlink" title="æœ¬è´¨ç‰¹å¾"></a>æœ¬è´¨ç‰¹å¾</h3><p>åŒºå—é“¾æœ¬è´¨æ˜¯ä¸€ä¸ªåˆ†å¸ƒå¼æ•°æ®åº“ï¼Œæ¯ä¸ªåŒºå—é€šè¿‡å“ˆå¸Œå€¼é“¾æ¥åˆ°å‰ä¸€ä¸ªåŒºå—ã€‚</p><h2 id="å…±è¯†æœºåˆ¶"><a href="#å…±è¯†æœºåˆ¶" class="headerlink" title="å…±è¯†æœºåˆ¶"></a>å…±è¯†æœºåˆ¶</h2><h3 id="ä¸ºä»€ä¹ˆéœ€è¦å…±è¯†"><a href="#ä¸ºä»€ä¹ˆéœ€è¦å…±è¯†" class="headerlink" title="ä¸ºä»€ä¹ˆéœ€è¦å…±è¯†"></a>ä¸ºä»€ä¹ˆéœ€è¦å…±è¯†</h3><ul><li>åŒºå—é“¾æ˜¯åˆ†å¸ƒå¼æ•°æ®åº“</li><li>æ²¡æœ‰ä¸­å¿ƒåŒ–æ§åˆ¶è€…</li><li>æ–°åŒºå—çš„åŠ å…¥éœ€è¦å…¶ä»–å‚ä¸è€…åŒæ„</li></ul><h3 id="å·¥ä½œé‡è¯æ˜-PoW"><a href="#å·¥ä½œé‡è¯æ˜-PoW" class="headerlink" title="å·¥ä½œé‡è¯æ˜(PoW)"></a>å·¥ä½œé‡è¯æ˜(PoW)</h3><p>éœ€è¦å®Œæˆç¹é‡çš„è®¡ç®—å·¥ä½œæ‰èƒ½è·å¾—æ·»åŠ æ–°åŒºå—çš„æƒåŠ›ã€‚</p><h2 id="å“ˆå¸Œå‡½æ•°åº”ç”¨"><a href="#å“ˆå¸Œå‡½æ•°åº”ç”¨" class="headerlink" title="å“ˆå¸Œå‡½æ•°åº”ç”¨"></a>å“ˆå¸Œå‡½æ•°åº”ç”¨</h2><p>å“ˆå¸Œå‡½æ•°ä¸»è¦ç”¨é€”ï¼š</p><ul><li>æ£€æµ‹æ•°æ®ä¸€è‡´æ€§</li><li>éªŒè¯æ–‡ä»¶å®Œæ•´æ€§</li><li>å»ºç«‹æ•°æ®ä¸å“ˆå¸Œå€¼çš„ä¸€ä¸€å¯¹åº”å…³ç³»</li></ul><h2 id="æ¯”ç‰¹å¸æŒ–çŸ¿ç®—æ³•"><a href="#æ¯”ç‰¹å¸æŒ–çŸ¿ç®—æ³•" class="headerlink" title="æ¯”ç‰¹å¸æŒ–çŸ¿ç®—æ³•"></a>æ¯”ç‰¹å¸æŒ–çŸ¿ç®—æ³•</h2><h3 id="è®¡ç®—è¿‡ç¨‹"><a href="#è®¡ç®—è¿‡ç¨‹" class="headerlink" title="è®¡ç®—è¿‡ç¨‹"></a>è®¡ç®—è¿‡ç¨‹</h3><ol><li>ç»„åˆæ•°æ®ï¼š<ul><li>æ—¶é—´æˆ³</li><li>å‰å“ˆå¸Œ</li><li>å®é™…data</li></ul></li><li>ä½¿ç”¨è®¡æ•°å™¨(nonce)é€’å¢</li><li>ä¸æ–­è®¡ç®—å“ˆå¸Œå€¼</li><li>ç›´åˆ°æ‰¾åˆ°ç¬¦åˆæ¡ä»¶çš„ç»“æœ</li></ol><h3 id="éš¾åº¦è¦æ±‚"><a href="#éš¾åº¦è¦æ±‚" class="headerlink" title="éš¾åº¦è¦æ±‚"></a>éš¾åº¦è¦æ±‚</h3><ul><li>ç›®æ ‡ï¼šå“ˆå¸Œå€¼å‰20ä½ä¸º0</li><li>æˆåŠŸæ¦‚ç‡ï¼š1/2^20</li><li>éªŒè¯æ–¹æ³•ï¼šæ¯”è¾ƒå“ˆå¸Œå€¼æ˜¯å¦å°äº0x000000â€¦</li></ul><p>psï¼šnonceæ˜¯ä¸€ä¸ªå¯†ç å­¦æœ¯è¯­ï¼Œåœ¨è¿™é‡Œä½œä¸ºè®¡æ•°å™¨ä½¿ç”¨ã€‚</p>]]></content>
    
    
    <summary type="html">ç®€è¦ä»‹ç»åŒºå—é“¾åŸºç¡€çŸ¥è¯†å’Œæ¯”ç‰¹å¸å·¥ä½œé‡è¯æ˜ç®—æ³•çš„æ ¸å¿ƒåŸç†</summary>
    
    
    
    <category term="åŒºå—é“¾æŠ€æœ¯" scheme="https://eatbreads.github.io/categories/%E5%8C%BA%E5%9D%97%E9%93%BE%E6%8A%80%E6%9C%AF/"/>
    
    
    <category term="åŒºå—é“¾" scheme="https://eatbreads.github.io/tags/%E5%8C%BA%E5%9D%97%E9%93%BE/"/>
    
    <category term="æ¯”ç‰¹å¸" scheme="https://eatbreads.github.io/tags/%E6%AF%94%E7%89%B9%E5%B8%81/"/>
    
    <category term="åŠ å¯†è´§å¸" scheme="https://eatbreads.github.io/tags/%E5%8A%A0%E5%AF%86%E8%B4%A7%E5%B8%81/"/>
    
  </entry>
  
  <entry>
    <title>éŸ³è§†é¢‘å¼€å‘å¸¸è§é¢è¯•é¢˜è§£æ(ä¸€)</title>
    <link href="https://eatbreads.github.io/posts/ee93bc5b.html"/>
    <id>https://eatbreads.github.io/posts/ee93bc5b.html</id>
    <published>2025-04-20T15:37:56.000Z</published>
    <updated>2025-04-20T15:39:10.894Z</updated>
    
    <content type="html"><![CDATA[<h1>éŸ³è§†é¢‘å¼€å‘æ ¸å¿ƒé—®é¢˜è§£æ</h1><h2 id="è§£ç ä¸æ¸²æŸ“æµç¨‹">è§£ç ä¸æ¸²æŸ“æµç¨‹</h2><h3 id="è§£ç è¿‡ç¨‹">è§£ç è¿‡ç¨‹</h3><ul><li>H.264è§£ç è¾“å‡ºï¼šYUV420P/YUVæ ¼å¼</li><li>AACè§£ç è¾“å‡ºï¼šPCMæ ¼å¼</li></ul><h3 id="æ¸²æŸ“å®ç°">æ¸²æŸ“å®ç°</h3><ul><li>ä½¿ç”¨OpenGLå°†YUVåˆ†é‡ä¸Šä¼ ä¸ºçº¹ç†</li><li>é€šè¿‡ç€è‰²å™¨å®ŒæˆYUVåˆ°RGBçš„è½¬æ¢</li></ul><h3 id="éŸ³è§†é¢‘åŒæ­¥">éŸ³è§†é¢‘åŒæ­¥</h3><ul><li>åˆ©ç”¨å¸§çš„PTSåšæ—¶é’ŸåŒæ­¥</li></ul><h3 id="éŸ³é¢‘å¸§ä¸¢å¤±å¤„ç†">éŸ³é¢‘å¸§ä¸¢å¤±å¤„ç†</h3><ol><li><p>è§†é¢‘ä¸¢å¸§æ–¹æ¡ˆ</p><ul><li>ä¸¢å¼ƒéƒ¨åˆ†è§†é¢‘å¸§ä½¿è§†é¢‘è¿½ä¸ŠéŸ³é¢‘</li></ul></li><li><p>éŸ³é¢‘è¡¥å¿æ–¹æ¡ˆ</p><ul><li>å¡«å……é™éŸ³æˆ–æ’å€¼è¡¥è¶³ç¼ºå¤±ç‰‡æ®µ</li><li>é€‚ç”¨äºä¸å…è®¸ä¸¢è§†é¢‘å¸§çš„åœºæ™¯</li></ul></li><li><p>åŠ¨æ€é€Ÿç‡è°ƒæ•´</p><ul><li>é€šè¿‡åŠ å¿«æˆ–å‡æ…¢è§†é¢‘æ’­æ”¾é‡æ–°åŒæ­¥</li></ul></li></ol><p>æ³¨ï¼šä¸¢å¸§æˆ–å¡«å……é™éŸ³æ˜¯ç›´æ’­åœºæ™¯ä¸‹æœ€å¸¸ç”¨çš„æ–¹æ¡ˆ</p><h2 id="èŠ±å±é—®é¢˜å¤„ç†">èŠ±å±é—®é¢˜å¤„ç†</h2><h3 id="äº§ç”ŸåŸå› ">äº§ç”ŸåŸå› </h3><ol><li><p>å…³é”®å¸§ä¸¢å¤±</p><ul><li>å¯¼è‡´åç»­Bå¸§å’ŒPå¸§æ— æ³•æ˜¾ç¤º</li></ul></li><li><p>å…ƒæ•°æ®å˜åŒ–</p><ul><li>åˆ†è¾¨ç‡ã€å¸§ç‡ã€ç¼–ç æ ¼å¼ç­‰å‚æ•°å˜åŒ–</li><li>æ’­æ”¾å™¨é€‚åº”é—®é¢˜</li></ul></li><li><p>ç¡¬ä»¶å…¼å®¹æ€§</p><ul><li>ä¸»è¦å‡ºç°åœ¨å®‰å“è®¾å¤‡</li></ul></li><li><p>é¢œè‰²æ ¼å¼ä¸ä¸€è‡´</p><ul><li>æ¨æµå’Œæ’­æ”¾ç«¯æ ¼å¼ä¸åŒ¹é…</li></ul></li></ol><h3 id="è§£å†³æ–¹æ¡ˆ">è§£å†³æ–¹æ¡ˆ</h3><ol><li><p>ä¸¢å¸§å¤„ç†ä¼˜åŒ–</p><ul><li>å¿…é¡»ä¸¢å¸§æ—¶åº”ä¸¢å¼ƒæ•´ä¸ªGOP</li></ul></li><li><p>å‚æ•°ç¨³å®šæ€§</p><ul><li>ä¿æŒç›´æ’­ç¼–ç å‚æ•°ç¨³å®š</li></ul></li><li><p>è§£ç æ–¹æ¡ˆè°ƒæ•´</p><ul><li>å°è¯•è½¯è§£ç å¯¹æ¯”</li><li>å»ºç«‹è®¾å¤‡å…¼å®¹æ€§åå•</li></ul></li><li><p>æ ¼å¼ç»Ÿä¸€</p><ul><li>ç»Ÿä¸€æ¨æµå’Œæ‹‰æµçš„é¢œè‰²æ ¼å¼</li></ul></li></ol><h2 id="è·³å¸§é—®é¢˜åˆ†æ">è·³å¸§é—®é¢˜åˆ†æ</h2><h3 id="åŸå› åˆ†æ">åŸå› åˆ†æ</h3><ol><li>å¸§ç‡ä¸åˆ·æ–°ç‡ä¸åŒ¹é…</li><li>è§£ç /æ¸²æŸ“æ€§èƒ½ä¸è¶³</li><li>ç½‘ç»œæŠ–åŠ¨å½±å“</li><li>éŸ³è§†é¢‘åŒæ­¥æœºåˆ¶é—®é¢˜</li></ol><h2 id="æœåŠ¡å™¨æ€§èƒ½è¯„ä¼°">æœåŠ¡å™¨æ€§èƒ½è¯„ä¼°</h2><h3 id="æµ‹è¯•ç»´åº¦">æµ‹è¯•ç»´åº¦</h3><ol><li><p>å¹¶å‘èƒ½åŠ›</p><ul><li>åŒæ—¶è§‚çœ‹å’Œæ¨æµè·¯æ•°</li></ul></li><li><p>å¸¦å®½è¯„ä¼°</p><ul><li>æ€»å‡ºå£å¸¦å®½</li><li>CDNåˆ†å‘èƒ½åŠ›</li></ul></li><li><p>è½¬ç è´Ÿè½½</p><ul><li>CPU/GPUèµ„æºè¯„ä¼°</li></ul></li><li><p>ç³»ç»Ÿç¨³å®šæ€§</p><ul><li>ç«¯åˆ°ç«¯å»¶è¿Ÿ</li><li>ä¸¢åŒ…ç‡</li><li>æ•…éšœæ¢å¤èƒ½åŠ›</li></ul></li></ol><h2 id="IPCæ‘„åƒå¤´æ–¹æ¡ˆ">IPCæ‘„åƒå¤´æ–¹æ¡ˆ</h2><h3 id="è®¾å¤‡æ¥æº">è®¾å¤‡æ¥æº</h3><ol><li>è‡ªç ”/ODM</li><li>ç¬¬ä¸‰æ–¹å‚å•†ï¼ˆæµ·åº·ã€å¤§åç­‰ï¼‰</li></ol><h3 id="é€šä¿¡åè®®">é€šä¿¡åè®®</h3><ol><li><p>RTSP+RTP</p><ul><li>ä¸»æµæ‘„åƒå¤´é»˜è®¤æ”¯æŒ</li></ul></li><li><p>GB28181</p><ul><li>å›½å†…å®‰é˜²æ ‡å‡†</li><li>SIP 5060ç«¯å£æ³¨å†Œ</li></ul></li><li><p>ONVIF</p><ul><li>å›½é™…é€šç”¨åè®®</li><li>æ”¯æŒè®¾å¤‡å‘ç°å’Œæ§åˆ¶</li></ul></li></ol><h2 id="éŸ³è§†é¢‘å¹³å°æ¶æ„">éŸ³è§†é¢‘å¹³å°æ¶æ„</h2><h3 id="æ ¸å¿ƒæ¨¡å—">æ ¸å¿ƒæ¨¡å—</h3><ol><li><p>ç”¨æˆ·æƒé™æ¨¡å—</p><ul><li>ç™»å½•è®¤è¯</li><li>é‰´æƒç®¡ç†</li><li>Tokenç®¡ç†</li></ul></li><li><p>å‰ç«¯/å®¢æˆ·ç«¯</p><ul><li>æ’­æ”¾åŠŸèƒ½</li><li>ç®¡ç†äº¤äº’</li></ul></li><li><p>æµåª’ä½“æœåŠ¡</p><ul><li>æ¨æµ/æ‹‰æµ</li><li>åè®®è½¬å‘</li><li>è½¬ç æ”¯æŒ</li></ul></li><li><p>å­˜å‚¨æœåŠ¡</p><ul><li>å½•åƒä¿å­˜</li><li>æˆªå›¾å­˜å‚¨</li><li>æ£€ç´¢å›æ”¾</li></ul></li><li><p>è®¾å¤‡ç®¡ç†</p><ul><li>æ‘„åƒå¤´æ³¨å†Œ</li><li>çŠ¶æ€ç›‘æ§</li><li>æ§åˆ¶å‘½ä»¤ä¸‹å‘</li></ul></li></ol>]]></content>
    
    
    <summary type="html">è¯¦ç»†è§£æéŸ³è§†é¢‘å¼€å‘ä¸­çš„å¸¸è§é¢è¯•é¢˜ï¼ŒåŒ…æ‹¬è§£ç æ¸²æŸ“ã€éŸ³è§†é¢‘åŒæ­¥ã€èŠ±å±å¤„ç†ç­‰æ ¸å¿ƒé—®é¢˜</summary>
    
    
    
    <category term="éŸ³è§†é¢‘å¼€å‘" scheme="https://eatbreads.github.io/categories/%E9%9F%B3%E8%A7%86%E9%A2%91%E5%BC%80%E5%8F%91/"/>
    
    
    <category term="éŸ³è§†é¢‘" scheme="https://eatbreads.github.io/tags/%E9%9F%B3%E8%A7%86%E9%A2%91/"/>
    
    <category term="FFmpeg" scheme="https://eatbreads.github.io/tags/FFmpeg/"/>
    
    <category term="é¢è¯•é¢˜" scheme="https://eatbreads.github.io/tags/%E9%9D%A2%E8%AF%95%E9%A2%98/"/>
    
  </entry>
  
  <entry>
    <title>c++é«˜æ€§èƒ½å®šæ—¶å™¨å®ç°</title>
    <link href="https://eatbreads.github.io/posts/9b96a9aa.html"/>
    <id>https://eatbreads.github.io/posts/9b96a9aa.html</id>
    <published>2025-04-19T15:40:01.000Z</published>
    <updated>2025-04-19T15:43:52.439Z</updated>
    
    <content type="html"><![CDATA[<h1>ç›´æ¥ä¸Šä»£ç </h1><ul><li>åˆ†ä¸ºä¸¤ç§,ä¸€ç§æ˜¯å¤šçº¿ç¨‹,ä¸€ç§æ˜¯æ—¶é—´çº¿</li></ul><p><img src="https://cdn-a.markji.com/files/665d1b26a552a1096b431e0a_hd.png?e=1745079714430&amp;token=xX63b9jqTlDOcGmctt5K9254rV0LG8hS9BmDeFBy:T3e2SKI2rJZDxMbrZUMOE08y7xU=" alt="å›¾ç‰‡1"><br>å¤šçº¿ç¨‹<br><img src="https://cdn-a.markji.com/files/665d1c76a552a1096b434126_hd.png?e=1745079714430&amp;token=xX63b9jqTlDOcGmctt5K9254rV0LG8hS9BmDeFBy:aUtkOolbkxAQmAYlIALpGfsQI7E=" alt="å›¾ç‰‡1"><br><img src="https://cdn-a.markji.com/files/665d1c856c5f0515e269b414_hd.png?e=1745079714430&amp;token=xX63b9jqTlDOcGmctt5K9254rV0LG8hS9BmDeFBy:yo_YNaaP25uc9dTjrUv40gzObRg=" alt="å›¾ç‰‡1"><br>æ—¶é—´çº¿<br><img src="https://cdn-a.markji.com/files/665d1c9fa552a1096b4343fc_hd.png?e=1745079714430&amp;token=xX63b9jqTlDOcGmctt5K9254rV0LG8hS9BmDeFBy:23Ja14SqyjRKfF6hreKLzGv9OsI=" alt="å›¾ç‰‡1"><br>äºŒæ›´ï¼šè¿™è¾¹å¤§äºnowå°±ä¼šç›´æ¥é€€å‡ºï¼Œå› ä¸ºmultmapæ˜¯é€’å¢æ’åºï¼Œåç»­çš„è‚¯å®šä¹Ÿæ˜¯å¤§äºçš„</p><p>ç„¶åè¿™ä¸ªå†…å±‚ifæ˜¯å¤„ç†æ–°åŠ çš„timeræ˜¯å¦è¦å¤„ç†çš„æ“ä½œ</p><p><img src="https://cdn-a.markji.com/files/665d1caca552a1096b4344dd_hd.png?e=1745079714431&amp;token=xX63b9jqTlDOcGmctt5K9254rV0LG8hS9BmDeFBy:bIH2WjAE2GeEgWkSotaPDXkV4p0=" alt="å›¾ç‰‡1"><br><img src="https://cdn-a.markji.com/files/665d1cbba552a1096b434603_hd.png?e=1745079714431&amp;token=xX63b9jqTlDOcGmctt5K9254rV0LG8hS9BmDeFBy:H95QUaSiuHzo-ic0ssQCXDKcoL0=" alt="å›¾ç‰‡1"><br><img src="https://cdn-a.markji.com/files/665d1cc7a552a1096b4346b0_hd.png?e=1745079714431&amp;token=xX63b9jqTlDOcGmctt5K9254rV0LG8hS9BmDeFBy:EGFfv1vxmawSyr-fg_GFmsuZz9o=" alt="å›¾ç‰‡1"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1&gt;ç›´æ¥ä¸Šä»£ç &lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;åˆ†ä¸ºä¸¤ç§,ä¸€ç§æ˜¯å¤šçº¿ç¨‹,ä¸€ç§æ˜¯æ—¶é—´çº¿&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img src=&quot;https://cdn-a.markji.com/files/665d1b26a552a1096b431e0a_hd.png?e=17450797</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>WebRTCçš„JavaScriptç®€å•å®ç°</title>
    <link href="https://eatbreads.github.io/posts/e8866bd2.html"/>
    <id>https://eatbreads.github.io/posts/e8866bd2.html</id>
    <published>2025-04-17T12:26:35.000Z</published>
    <updated>2025-04-17T15:28:53.308Z</updated>
    
    <content type="html"><![CDATA[<h1>WebRTCè§†é¢‘èŠå¤©å®ç°</h1><h2 id="æ ¸å¿ƒåŠŸèƒ½å®ç°">æ ¸å¿ƒåŠŸèƒ½å®ç°</h2><h3 id="1-è¯·æ±‚è®¿é—®ç”¨æˆ·è®¾å¤‡">1. è¯·æ±‚è®¿é—®ç”¨æˆ·è®¾å¤‡</h3><p>ä½¿ç”¨<code>navigator.mediaDevices.getUserMedia()</code>è¯·æ±‚è®¿é—®ç”¨æˆ·çš„æ‘„åƒå¤´å’Œéº¦å…‹é£</p><h3 id="2-åˆ›å»ºPeerè¿æ¥">2. åˆ›å»ºPeerè¿æ¥</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> peer = <span class="keyword">new</span> <span class="title class_">Peer</span>();</span><br><span class="line">peer.<span class="title function_">on</span>(<span class="string">&#x27;open&#x27;</span>, <span class="keyword">function</span>(<span class="params">id</span>) &#123;</span><br><span class="line">    <span class="comment">// è¿æ¥æˆåŠŸåè·å–ID</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h3 id="3-ç›‘å¬å¤–éƒ¨è¿æ¥">3. ç›‘å¬å¤–éƒ¨è¿æ¥</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">peer.<span class="title function_">on</span>(<span class="string">&#x27;call&#x27;</span>, <span class="keyword">function</span>(<span class="params">call</span>) &#123;</span><br><span class="line">    <span class="comment">// ç›‘å¬æ¥ç”µ</span></span><br><span class="line">    call.<span class="title function_">answer</span>(localStream);  <span class="comment">// å›å¤å¹¶å‘é€æœ¬åœ°è§†é¢‘æµ</span></span><br><span class="line">    call.<span class="title function_">on</span>(<span class="string">&#x27;stream&#x27;</span>, <span class="keyword">function</span>(<span class="params">remoteStream</span>) &#123;</span><br><span class="line">        <span class="comment">// ç›‘å¬å¯¹æ–¹çš„è¿œç¨‹è§†é¢‘æµ</span></span><br><span class="line">    &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h3 id="4-å‘èµ·é€šä¿¡">4. å‘èµ·é€šä¿¡</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">peer.<span class="title function_">call</span>(remoteId, localStream);</span><br></pre></td></tr></table></figure><h2 id="å®Œæ•´ä»£ç å®ç°">å®Œæ•´ä»£ç å®ç°</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>è§†é¢‘èŠå¤©<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;utf-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://cdn.jsdelivr.net/npm/jquery/dist/jquery.min.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://cdn.bootcdn.net/ajax/libs/peerjs/1.3.1/peerjs.min.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h3</span>&gt;</span>æœ¬åœ°è§†é¢‘<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">video</span> <span class="attr">id</span>=<span class="string">&quot;localVideo&quot;</span> <span class="attr">style</span>=<span class="string">&quot;width: 400px;height: 300px;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">video</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">&quot;text-align: left&quot;</span>&gt;</span></span><br><span class="line">    è‡ªå·±ID<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">id</span>=<span class="string">&quot;myPeerid&quot;</span>/&gt;</span>(è‡ªåŠ¨è·å–)</span><br><span class="line">    å¯¹æ–¹ID<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">id</span>=<span class="string">&quot;youPeerid&quot;</span>/&gt;</span>(è¯·æ‰‹åŠ¨è¾“å…¥)</span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span> <span class="attr">id</span>=<span class="string">&quot;callBtn&quot;</span>&gt;</span>èŠå¤©<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h3</span>&gt;</span>è¿œç¨‹è§†é¢‘<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">video</span> <span class="attr">id</span>=<span class="string">&quot;remoteVideo&quot;</span> <span class="attr">style</span>=<span class="string">&quot;width: 400px;height: 300px;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">video</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="comment">//è®¿é—®ç”¨æˆ·åª’ä½“è®¾å¤‡çš„å…¼å®¹æ–¹æ³•</span></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">function</span> <span class="title function_">getUserMedia</span>(<span class="params">constrains,success,error</span>)&#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">if</span>(navigator.<span class="property">mediaDevices</span>.<span class="property">getUserMedia</span>)&#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="comment">//æœ€æ–°æ ‡å‡†API</span></span></span><br><span class="line"><span class="language-javascript">            navigator.<span class="property">mediaDevices</span>.<span class="title function_">getUserMedia</span>(constrains).<span class="title function_">then</span>(success).<span class="title function_">catch</span>(error);</span></span><br><span class="line"><span class="language-javascript">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (navigator.<span class="property">webkitGetUserMedia</span>)&#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="comment">//webkitå†…æ ¸æµè§ˆå™¨</span></span></span><br><span class="line"><span class="language-javascript">            navigator.<span class="title function_">webkitGetUserMedia</span>(constrains).<span class="title function_">then</span>(success).<span class="title function_">catch</span>(error);</span></span><br><span class="line"><span class="language-javascript">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (navigator.<span class="property">mozGetUserMedia</span>)&#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="comment">//Firefoxæµè§ˆå™¨</span></span></span><br><span class="line"><span class="language-javascript">            navagator.<span class="title function_">mozGetUserMedia</span>(constrains).<span class="title function_">then</span>(success).<span class="title function_">catch</span>(error);</span></span><br><span class="line"><span class="language-javascript">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (navigator.<span class="property">getUserMedia</span>)&#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="comment">//æ—§ç‰ˆAPI</span></span></span><br><span class="line"><span class="language-javascript">            navigator.<span class="title function_">getUserMedia</span>(constrains).<span class="title function_">then</span>(success).<span class="title function_">catch</span>(error);</span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">var</span> localVideo = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;video#localVideo&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">var</span> remoteVideo = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;video#remoteVideo&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">var</span> localStream = <span class="literal">null</span>;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    $(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// è·å–æœ¬åœ°åª’ä½“æµ</span></span></span><br><span class="line"><span class="language-javascript">        <span class="title function_">getUserMedia</span>(&#123;<span class="attr">video</span>: <span class="literal">true</span>, <span class="attr">audio</span>: <span class="literal">true</span>&#125;, <span class="keyword">function</span>(<span class="params">stream</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">            localStream = stream;</span></span><br><span class="line"><span class="language-javascript">            localVideo.<span class="property">srcObject</span> = stream;</span></span><br><span class="line"><span class="language-javascript">            localVideo.<span class="property">autoplay</span> = <span class="literal">true</span>;</span></span><br><span class="line"><span class="language-javascript">            localVideo.<span class="title function_">play</span>();</span></span><br><span class="line"><span class="language-javascript">        &#125;, <span class="keyword">function</span>(<span class="params">err</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Failed to get local stream&#x27;</span> ,err);</span></span><br><span class="line"><span class="language-javascript">        &#125;);</span></span><br><span class="line"><span class="language-javascript"> </span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// åˆ›å»ºPeerè¿æ¥</span></span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">var</span> peer = <span class="keyword">new</span> <span class="title class_">Peer</span>();</span></span><br><span class="line"><span class="language-javascript">        peer.<span class="title function_">on</span>(<span class="string">&#x27;open&#x27;</span>, <span class="keyword">function</span>(<span class="params">id</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">            $(<span class="string">&quot;#myPeerid&quot;</span>).<span class="title function_">val</span>(id);</span></span><br><span class="line"><span class="language-javascript">        &#125;);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// ç›‘å¬å‘¼å«</span></span></span><br><span class="line"><span class="language-javascript">        peer.<span class="title function_">on</span>(<span class="string">&#x27;call&#x27;</span>, <span class="keyword">function</span>(<span class="params">call</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">            call.<span class="title function_">answer</span>(localStream);</span></span><br><span class="line"><span class="language-javascript">            call.<span class="title function_">on</span>(<span class="string">&#x27;stream&#x27;</span>, <span class="keyword">function</span>(<span class="params">remoteStream</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="variable language_">console</span>.<span class="title function_">log</span>(remoteStream);</span></span><br><span class="line"><span class="language-javascript">                remoteVideo.<span class="property">srcObject</span> = remoteStream;</span></span><br><span class="line"><span class="language-javascript">                remoteVideo.<span class="property">autoplay</span> = <span class="literal">true</span>;</span></span><br><span class="line"><span class="language-javascript">            &#125;);</span></span><br><span class="line"><span class="language-javascript">        &#125;);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// å‘èµ·å‘¼å«</span></span></span><br><span class="line"><span class="language-javascript">        $(<span class="string">&#x27;#callBtn&#x27;</span>).<span class="title function_">click</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">var</span> remoteId = $(<span class="string">&quot;#youPeerid&quot;</span>).<span class="title function_">val</span>();</span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">if</span>(remoteId == <span class="string">&quot;&quot;</span>)&#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="title function_">alert</span>(<span class="string">&quot;è¯·è¾“å…¥å¯¹æ–¹ID&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">                <span class="keyword">return</span>;</span></span><br><span class="line"><span class="language-javascript">            &#125;</span></span><br><span class="line"><span class="language-javascript"> </span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">var</span> call = peer.<span class="title function_">call</span>(remoteId, localStream);</span></span><br><span class="line"><span class="language-javascript">            call.<span class="title function_">on</span>(<span class="string">&#x27;stream&#x27;</span>, <span class="keyword">function</span>(<span class="params">remoteStream</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="variable language_">console</span>.<span class="title function_">log</span>(remoteStream);</span></span><br><span class="line"><span class="language-javascript">                remoteVideo.<span class="property">srcObject</span> = remoteStream;</span></span><br><span class="line"><span class="language-javascript">                remoteVideo.<span class="property">autoplay</span> = <span class="literal">true</span>;</span></span><br><span class="line"><span class="language-javascript">            &#125;);</span></span><br><span class="line"><span class="language-javascript">            call.<span class="title function_">on</span>(<span class="string">&#x27;close&#x27;</span>, <span class="keyword">function</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;call close&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">                _this.<span class="property">loading</span>.<span class="title function_">close</span>();</span></span><br><span class="line"><span class="language-javascript">            &#125;);</span></span><br><span class="line"><span class="language-javascript">            call.<span class="title function_">on</span>(<span class="string">&#x27;error&#x27;</span>, <span class="keyword">function</span>(<span class="params">err</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="variable language_">console</span>.<span class="title function_">log</span>(err);</span></span><br><span class="line"><span class="language-javascript">                _this.<span class="property">loading</span>.<span class="title function_">close</span>();</span></span><br><span class="line"><span class="language-javascript">            &#125;);</span></span><br><span class="line"><span class="language-javascript">        &#125;);</span></span><br><span class="line"><span class="language-javascript">    &#125;);</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="åŠŸèƒ½è¯´æ˜">åŠŸèƒ½è¯´æ˜</h2><ol><li>é¡µé¢åŠ è½½åè‡ªåŠ¨è¯·æ±‚æ‘„åƒå¤´æƒé™</li><li>è¿æ¥æˆåŠŸåè‡ªåŠ¨è·å–å¹¶æ˜¾ç¤ºæœ¬åœ°ID</li><li>è¾“å…¥å¯¹æ–¹IDåå¯å‘èµ·è§†é¢‘é€šè¯</li><li>æ”¯æŒæ¥æ”¶å¯¹æ–¹è§†é¢‘é€šè¯è¯·æ±‚</li><li>è‡ªåŠ¨æ˜¾ç¤ºæœ¬åœ°å’Œè¿œç¨‹è§†é¢‘æµ</li></ol><h2 id="å…¼å®¹æ€§å¤„ç†">å…¼å®¹æ€§å¤„ç†</h2><p>ä»£ç ä¸­åŒ…å«äº†å¯¹ä¸åŒæµè§ˆå™¨çš„å…¼å®¹å¤„ç†ï¼š</p><ul><li>æœ€æ–°æ ‡å‡†API</li><li>webkitå†…æ ¸æµè§ˆå™¨</li><li>Firefoxæµè§ˆå™¨</li><li>æ—§ç‰ˆAPI</li></ul>]]></content>
    
    
    <summary type="html">ä½¿ç”¨JavaScriptå®ç°åŸºäºWebRTCçš„è§†é¢‘èŠå¤©åŠŸèƒ½ï¼ŒåŒ…æ‹¬è·å–åª’ä½“æµã€å»ºç«‹P2Pè¿æ¥ç­‰æ ¸å¿ƒåŠŸèƒ½</summary>
    
    
    
    <category term="å‰ç«¯å¼€å‘" scheme="https://eatbreads.github.io/categories/%E5%89%8D%E7%AB%AF%E5%BC%80%E5%8F%91/"/>
    
    
    <category term="éŸ³è§†é¢‘" scheme="https://eatbreads.github.io/tags/%E9%9F%B3%E8%A7%86%E9%A2%91/"/>
    
    <category term="WebRTC" scheme="https://eatbreads.github.io/tags/WebRTC/"/>
    
    <category term="JavaScript" scheme="https://eatbreads.github.io/tags/JavaScript/"/>
    
  </entry>
  
  <entry>
    <title>å¸¸è§çš„å°è£…æ ¼å¼mp4,flv,hls</title>
    <link href="https://eatbreads.github.io/posts/109395ab.html"/>
    <id>https://eatbreads.github.io/posts/109395ab.html</id>
    <published>2025-04-16T15:51:09.000Z</published>
    <updated>2025-04-17T06:55:21.315Z</updated>
    
    
    
    
    
  </entry>
  
  <entry>
    <title>ç›´æ’­åè®®æ‘˜è¦ä»‹ç»RTMP-HTTP-FLV-WebRTC-RTSPç­‰</title>
    <link href="https://eatbreads.github.io/posts/c0a1f903.html"/>
    <id>https://eatbreads.github.io/posts/c0a1f903.html</id>
    <published>2025-04-16T15:43:36.000Z</published>
    <updated>2025-04-16T15:50:05.515Z</updated>
    
    <content type="html"><![CDATA[<h1 id="éŸ³è§†é¢‘åè®®è¯¦è§£"><a href="#éŸ³è§†é¢‘åè®®è¯¦è§£" class="headerlink" title="éŸ³è§†é¢‘åè®®è¯¦è§£"></a>éŸ³è§†é¢‘åè®®è¯¦è§£</h1><h2 id="RTMP-HTTP-FLV"><a href="#RTMP-HTTP-FLV" class="headerlink" title="RTMP/HTTP-FLV"></a>RTMP/HTTP-FLV</h2><p>è¿™ä¸¤ç§åè®®éƒ½å»ºç«‹åœ¨FLVå°è£…ä¹‹ä¸Šï¼Œä¸”ä¸€èˆ¬ä¸å†™å…¥ç£ç›˜ï¼Œä»…åœ¨å†…å­˜ä¸­äº¤æ¢ã€‚</p><h3 id="RTMP"><a href="#RTMP" class="headerlink" title="RTMP"></a>RTMP</h3><ul><li>ç”¨äºç›´æ’­æºæ¨æµå’Œç³»ç»Ÿå†…ç›´æ’­æµæ•°æ®ä¼ é€’</li><li>ç«¯å£å·1935ï¼Œå»ºç«‹TCPé•¿è¿æ¥</li><li>å»¶è¿Ÿä¸€èˆ¬ä¸º1~3s</li><li>æ¨æµåœ°å€å’Œæ’­æ”¾åœ°å€ç›¸åŒ</li><li>å­˜åœ¨é«˜å¹¶å‘é—®é¢˜</li><li>å› æµè§ˆå™¨æ‘’å¼ƒflashï¼Œä¸»è¦ç”¨äºç›´æ’­æºæ¨æµå’ŒCDNæ¨æµ</li><li>å¼ºåˆ¶åˆ‡ç‰‡ä»¥ä¿è¯å®æ—¶æ€§å’Œå¼±ç½‘æŠµæŠ—èƒ½åŠ›ï¼Œä½†æœ‰æ€§èƒ½æŸè€—</li></ul><h3 id="HTTP-FLV"><a href="#HTTP-FLV" class="headerlink" title="HTTP-FLV"></a>HTTP-FLV</h3><ul><li>ä¸»è¦ç”¨äºå®¢æˆ·ç«¯è§‚çœ‹</li><li>æ˜¯RTMPçš„HTTPç‰ˆæœ¬</li><li>ç½‘é¡µéœ€è¦å¼•å…¥flv.jsæ‰èƒ½æ’­æ”¾</li></ul><h2 id="WebRTCåè®®"><a href="#WebRTCåè®®" class="headerlink" title="WebRTCåè®®"></a>WebRTCåè®®</h2><h3 id="åŸºæœ¬ç‰¹æ€§"><a href="#åŸºæœ¬ç‰¹æ€§" class="headerlink" title="åŸºæœ¬ç‰¹æ€§"></a>åŸºæœ¬ç‰¹æ€§</h3><ul><li>Web Real-Time Communication</li><li>å…è®¸æµè§ˆå™¨ä¹‹é—´ç›´æ¥è¿æ¥</li><li>å»¶è¿Ÿä½äº1sï¼Œä½¿ç”¨UDPé€šé“</li><li>æ¨æ‹‰æµåœ°å€æ ¼å¼ï¼š<code>webrtc://127.0.0.1:8000/live</code></li></ul><h3 id="è¿æ¥æœºåˆ¶"><a href="#è¿æ¥æœºåˆ¶" class="headerlink" title="è¿æ¥æœºåˆ¶"></a>è¿æ¥æœºåˆ¶</h3><ol><li>ç‚¹å¯¹ç‚¹åè®®(PPP)</li><li>éœ€è¦ä¿¡ä»¤æœåŠ¡å™¨ä½œä¸ºåˆå§‹ä¸­è½¬</li><li>ä¿¡ä»¤å†…å®¹åŒ…æ‹¬ï¼š<ul><li>åª’ä½“æµå…ƒæ•°æ®</li><li>ç½‘ç»œæ•°æ®ä¿¡æ¯</li></ul></li></ol><h3 id="è¿æ¥æ–¹å¼"><a href="#è¿æ¥æ–¹å¼" class="headerlink" title="è¿æ¥æ–¹å¼"></a>è¿æ¥æ–¹å¼</h3><ol><li>æœ¬åœ°å±€åŸŸç½‘ç›´æ¥é€šä¿¡</li><li>é€šè¿‡STUNæœåŠ¡å™¨è·å–å…¬ç½‘IP</li><li>TURNæœåŠ¡å™¨ä½œä¸ºå¤‡é€‰æ–¹æ¡ˆ</li></ol><h3 id="å¤šå¯¹å¤šé€šä¿¡æ¨¡å¼"><a href="#å¤šå¯¹å¤šé€šä¿¡æ¨¡å¼" class="headerlink" title="å¤šå¯¹å¤šé€šä¿¡æ¨¡å¼"></a>å¤šå¯¹å¤šé€šä¿¡æ¨¡å¼</h3><ol><li><p>Meshæ¨¡å¼</p><ul><li>ä¼˜ç‚¹ï¼šå®ç°ç®€å•</li><li>ç¼ºç‚¹ï¼šä»…æ”¯æŒ4-6äºº</li></ul></li><li><p>MCUæ¨¡å¼</p><ul><li>ä¼˜ç‚¹ï¼šæ”¯æŒå¤šäºº</li><li>ç¼ºç‚¹ï¼šæœåŠ¡å™¨å‹åŠ›å¤§</li></ul></li><li><p>SFUæ¨¡å¼</p><ul><li>ä¼˜ç‚¹ï¼šæœåŠ¡å™¨å‹åŠ›é€‚ä¸­</li><li>ç¼ºç‚¹ï¼šå¸¦å®½æ¶ˆè€—å¤§</li><li>é€‚ç”¨äºä¸€å¯¹å¤šé€šä¿¡</li></ul></li></ol><h2 id="RTSPåè®®"><a href="#RTSPåè®®" class="headerlink" title="RTSPåè®®"></a>RTSPåè®®</h2><ul><li>ä¸»è¦ç”¨äºæ‘„åƒå¤´/ç›‘æ§è®¾å¤‡</li><li>æ”¯æŒTCP/UDPåˆ‡æ¢</li><li>æ”¯æŒæ¨æµæ‹‰æµ</li><li>æ”¯æŒç‚¹æ’­ç›´æ’­</li><li>ç°ä»£æµè§ˆå™¨ä¸æ”¯æŒ</li></ul><h2 id="ç›´æ’­ç³»ç»Ÿæ¶æ„"><a href="#ç›´æ’­ç³»ç»Ÿæ¶æ„" class="headerlink" title="ç›´æ’­ç³»ç»Ÿæ¶æ„"></a>ç›´æ’­ç³»ç»Ÿæ¶æ„</h2><h3 id="å·¥ä½œæµç¨‹"><a href="#å·¥ä½œæµç¨‹" class="headerlink" title="å·¥ä½œæµç¨‹"></a>å·¥ä½œæµç¨‹</h3><figure class="highlight clean"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ç›´æ’­æº -&gt; æœåŠ¡å™¨<span class="number">1</span> -&gt; è½¬ç å¤„ç† -&gt; æœåŠ¡å™¨<span class="number">2</span> -&gt; å®¢æˆ·ç«¯</span><br></pre></td></tr></table></figure><h3 id="åŠŸèƒ½ç‰¹æ€§"><a href="#åŠŸèƒ½ç‰¹æ€§" class="headerlink" title="åŠŸèƒ½ç‰¹æ€§"></a>åŠŸèƒ½ç‰¹æ€§</h3><ul><li>æ”¯æŒè½¬ç å¤„ç†</li><li>æ”¯æŒæ°´å°æ·»åŠ </li><li>æ”¯æŒæ¸…æ™°åº¦è½¬æ¢</li><li>æ”¯æŒç ç‡é™åˆ¶</li><li>æ”¯æŒç›´æ’­å½•åƒ</li></ul><h2 id="å°è£…æ ¼å¼å¯¹æ¯”"><a href="#å°è£…æ ¼å¼å¯¹æ¯”" class="headerlink" title="å°è£…æ ¼å¼å¯¹æ¯”"></a>å°è£…æ ¼å¼å¯¹æ¯”</h2><h3 id="MP4"><a href="#MP4" class="headerlink" title="MP4"></a>MP4</h3><ul><li>æ”¯æŒè‡ªå®šä¹‰å°é¢</li><li>æ ‘çŠ¶ç»“æ„æ•°æ®å—</li><li>ä¸»è¦æ•°æ®å—ï¼š<ul><li>ftypï¼šç¼–ç æ ¼å¼ä¿¡æ¯</li><li>moovï¼šå…ƒæ•°æ®</li><li>mdatï¼šéŸ³è§†é¢‘æ•°æ®</li></ul></li></ul><h3 id="FLV"><a href="#FLV" class="headerlink" title="FLV"></a>FLV</h3><ul><li>é€‚åˆç½‘ç»œè§†é¢‘æ’­æ”¾</li><li>å¤§æ–‡ä»¶/é•¿æ—¶é—´æ’­æ”¾ç¨³å®š</li><li>æ”¯æŒæ—¶é—´æˆ³ç´¢å¼•</li><li>éœ€è¦å»ºç«‹Iå¸§ç´¢å¼•</li></ul><h3 id="HLS"><a href="#HLS" class="headerlink" title="HLS"></a>HLS</h3><ul><li>åŸºäºHTTPä¸‹è½½</li><li>ç”±tsæ–‡ä»¶å’Œm3u8ç´¢å¼•ç»„æˆ</li><li>æ”¯æŒäºŒçº§ç´¢å¼•</li><li>å»¶è¿Ÿè¾ƒå¤§(5~30ç§’)</li></ul><h2 id="H-264ç¼–ç åŸç†"><a href="#H-264ç¼–ç åŸç†" class="headerlink" title="H.264ç¼–ç åŸç†"></a>H.264ç¼–ç åŸç†</h2><h3 id="ç æµåˆ†å±‚"><a href="#ç æµåˆ†å±‚" class="headerlink" title="ç æµåˆ†å±‚"></a>ç æµåˆ†å±‚</h3><ul><li>VALï¼šè§†é¢‘ç¼–ç å±‚</li><li>NALï¼šç½‘ç»œæå–å±‚</li></ul><h3 id="å¸§ç±»å‹"><a href="#å¸§ç±»å‹" class="headerlink" title="å¸§ç±»å‹"></a>å¸§ç±»å‹</h3><ul><li>Iå¸§ï¼šå®Œæ•´å¸§</li><li>På¸§ï¼šå·®å¼‚ç¼–ç </li><li>Bå¸§ï¼šåŒå‘å‚è€ƒ</li><li>IDRå¸§ï¼šé‡ç½®å‚è€ƒ</li><li>GOPç»„ï¼šå…³é”®å¸§ç»„</li></ul><h3 id="å‚æ•°ä¼˜åŒ–"><a href="#å‚æ•°ä¼˜åŒ–" class="headerlink" title="å‚æ•°ä¼˜åŒ–"></a>å‚æ•°ä¼˜åŒ–</h3><ol><li>ç ç‡æ§åˆ¶</li><li>åˆ†è¾¨ç‡/å¸§ç‡è°ƒæ•´</li><li>GOPè®¾ç½®ï¼š<ul><li>åœ¨çº¿æ’­æ”¾ï¼šå¸§ç‡çš„4-5å€</li><li>ç›´æ’­ï¼šå¸§ç‡çš„1-2å€</li></ul></li></ol><h3 id="æ¨æµå‘½ä»¤ç¤ºä¾‹"><a href="#æ¨æµå‘½ä»¤ç¤ºä¾‹" class="headerlink" title="æ¨æµå‘½ä»¤ç¤ºä¾‹"></a>æ¨æµå‘½ä»¤ç¤ºä¾‹</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.\ffmpeg -re -f dshow -i video=<span class="string">&quot;USB2.0 HD UVC WebCam&quot;</span> -vcodec libx264 -acodec aac -f flv -g 60 -bf 0 rtmp://127.0.0.1/live/test</span><br></pre></td></tr></table></figure><p>å‚æ•°è¯´æ˜ï¼š</p><ul><li><code>-re</code>ï¼šæŒ‰åŸå¸§ç‡è¯»å–</li><li><code>-f dshow</code>ï¼šWindowsè§†é¢‘è·å–</li><li><code>-g 60</code>ï¼šGOPå¤§å°</li><li><code>-bf 0</code>ï¼šç¦ç”¨Bå¸§</li></ul>]]></content>
    
    
    <summary type="html">è¯¦ç»†ä»‹ç»å„ç§éŸ³è§†é¢‘ç›´æ’­åè®®çš„ç‰¹ç‚¹å’Œåº”ç”¨åœºæ™¯ï¼ŒåŒ…æ‹¬RTMPã€HTTP-FLVã€WebRTCã€RTSPç­‰</summary>
    
    
    
    <category term="éŸ³è§†é¢‘å¼€å‘" scheme="https://eatbreads.github.io/categories/%E9%9F%B3%E8%A7%86%E9%A2%91%E5%BC%80%E5%8F%91/"/>
    
    
    <category term="ç½‘ç»œåè®®" scheme="https://eatbreads.github.io/tags/%E7%BD%91%E7%BB%9C%E5%8D%8F%E8%AE%AE/"/>
    
    <category term="éŸ³è§†é¢‘" scheme="https://eatbreads.github.io/tags/%E9%9F%B3%E8%A7%86%E9%A2%91/"/>
    
    <category term="ç›´æ’­" scheme="https://eatbreads.github.io/tags/%E7%9B%B4%E6%92%AD/"/>
    
  </entry>
  
  <entry>
    <title>ä¼˜åŒ–ZLMediakitçš„ç›´æ’­æ’­æ”¾</title>
    <link href="https://eatbreads.github.io/posts/1b73edcd.html"/>
    <id>https://eatbreads.github.io/posts/1b73edcd.html</id>
    <published>2025-04-15T16:26:32.000Z</published>
    <updated>2025-04-15T16:28:52.020Z</updated>
    
    <content type="html"><![CDATA[<h1>ZLMediakitç›´æ’­ç³»ç»Ÿä¼˜åŒ–</h1><h2 id="ç›´æ’­åè®®é€‰æ‹©">ç›´æ’­åè®®é€‰æ‹©</h2><h3 id="æœ€ä½³å®è·µ">æœ€ä½³å®è·µ</h3><ul><li>æ¨æµç«¯ï¼šä½¿ç”¨RTMPåè®®</li><li>æ‹‰æµç«¯ï¼šä½¿ç”¨HTTP-FLVåè®®</li></ul><h2 id="ç¼–ç å‚æ•°ä¼˜åŒ–">ç¼–ç å‚æ•°ä¼˜åŒ–</h2><h3 id="å…³é”®é…ç½®">å…³é”®é…ç½®</h3><ol><li>ç¦ç”¨Bå¸§</li><li>GOPå¤§å°è®¾ç½®ä¸ºå¸§ç‡çš„1-2å€<ul><li>é˜²æ­¢é•¿æ—¶é—´ä¸å‡ºç°Iå¸§</li><li>æœ‰åˆ©äºæ–°è§‚ä¼—å¿«é€ŸåŠ å…¥ç›´æ’­</li></ul></li></ol><h2 id="å®ç°å‘½ä»¤">å®ç°å‘½ä»¤</h2><h3 id="æ¨æµå‘½ä»¤">æ¨æµå‘½ä»¤</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.\ffmpeg -re -f dshow -i video=<span class="string">&quot;USB2.0 HD UVC WebCam&quot;</span> -vcodec libx264 -acodec aac -f flv -g 60 -bf 0 rtmp://127.0.0.1/live/test</span><br></pre></td></tr></table></figure><p>å‚æ•°è¯´æ˜ï¼š</p><ul><li><code>-g 60</code>: è®¾ç½®GOPå¤§å°</li><li><code>-bf 0</code>: ç¦ç”¨Bå¸§</li></ul><h3 id="æ’­æ”¾åœ°å€">æ’­æ”¾åœ°å€</h3><ol><li>RTMPæ’­æ”¾åœ°å€ï¼ˆæ¨èç”¨äºç›´æ’­ï¼‰ï¼š</li></ol><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rtmp:<span class="regexp">//</span><span class="number">127.0</span>.<span class="number">0.1</span><span class="regexp">/live/</span>test</span><br></pre></td></tr></table></figure><ol start="2"><li>HTTP-FLVæ’­æ”¾åœ°å€ï¼š</li></ol><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:<span class="regexp">//</span><span class="number">127.0</span>.<span class="number">0.1</span>:<span class="number">8080</span><span class="regexp">/live/</span>test.live.flv</span><br></pre></td></tr></table></figure><p>æ³¨ï¼šä¸¤ç§åè®®éƒ½å¯ç”¨äºæ‹‰æµï¼Œä½†æ¨èä½¿ç”¨HTTP-FLV</p>]]></content>
    
    
    <summary type="html">ä»‹ç»ZLMediakitç›´æ’­ç³»ç»Ÿä¼˜åŒ–æ–¹æ¡ˆï¼ŒåŒ…æ‹¬æ¨æµåè®®é€‰æ‹©ã€ç¼–ç å‚æ•°è°ƒä¼˜ç­‰å†…å®¹</summary>
    
    
    
    <category term="éŸ³è§†é¢‘å¼€å‘" scheme="https://eatbreads.github.io/categories/%E9%9F%B3%E8%A7%86%E9%A2%91%E5%BC%80%E5%8F%91/"/>
    
    
    <category term="FFmpeg" scheme="https://eatbreads.github.io/tags/FFmpeg/"/>
    
    <category term="ZLMediakit" scheme="https://eatbreads.github.io/tags/ZLMediakit/"/>
    
    <category term="ç›´æ’­" scheme="https://eatbreads.github.io/tags/%E7%9B%B4%E6%92%AD/"/>
    
  </entry>
  
  <entry>
    <title>ä½¿ç”¨ZLMediakitå®ç°ç‚¹æ’­åŠŸèƒ½</title>
    <link href="https://eatbreads.github.io/posts/edbebd32.html"/>
    <id>https://eatbreads.github.io/posts/edbebd32.html</id>
    <published>2025-04-14T16:15:26.000Z</published>
    <updated>2025-04-14T16:20:13.616Z</updated>
    
    <content type="html"><![CDATA[<h1>ZLMediakitç‚¹æ’­åŠŸèƒ½å®ç°</h1><h2 id="æ–‡ä»¶è®¿é—®é…ç½®">æ–‡ä»¶è®¿é—®é…ç½®</h2><h3 id="URLæ ¼å¼">URLæ ¼å¼</h3><p>ç‚¹æ’­æ–‡ä»¶URLæ ¼å¼ï¼š</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rtsp:<span class="regexp">//</span><span class="number">127.0</span>.<span class="number">0.1</span><span class="regexp">/record/</span>dd.mp4</span><br></pre></td></tr></table></figure><h3 id="æŒ‚è½½é—®é¢˜æ’æŸ¥">æŒ‚è½½é—®é¢˜æ’æŸ¥</h3><ol><li>æ–‡ä»¶åŒæ­¥é—®é¢˜</li></ol><ul><li>Windows Dockeræ¡¥æ¥æŒ‚è½½ä¸ä¼šå®æ—¶åŒæ­¥æ–°å¢å†…å®¹</li><li>æ–‡ä»¶å†™å…¥æ™šäºå®¹å™¨å¯åŠ¨</li><li>è§£å†³æ–¹æ¡ˆï¼šé‡å¯å®¹å™¨</li></ul><ol start="2"><li>æŒ‚è½½ä½ç½®é—®é¢˜</li></ol><ul><li>åˆå§‹æŒ‚è½½ä½ç½®é”™è¯¯</li><li>ä¿®æ”¹æŒ‚è½½ç‚¹åå¯ä»¥åœ¨ç½‘é¡µæ‰§è¡Œæ’­æ”¾</li></ul><h2 id="é…ç½®è°ƒæ•´">é…ç½®è°ƒæ•´</h2><h3 id="æœåŠ¡å™¨é…ç½®">æœåŠ¡å™¨é…ç½®</h3><ul><li>ä¿®æ”¹protocolè·¯å¾„</li><li>éœ€è¦æ­£ç¡®é…ç½®æŒ‚è½½ç‚¹<br><img src="https://cdn-a.markji.com/files/67fbee472d0565736319cf54_hd.png?e=1744648123046&amp;token=xX63b9jqTlDOcGmctt5K9254rV0LG8hS9BmDeFBy:gJqxn8ma3pVA1k0Em2neCyO-ues=" alt="å›¾ç‰‡1"><br><img src="https://cdn-a.markji.com/files/67fbecaf75151df2bbdde516_hd.png?e=1744648123046&amp;token=xX63b9jqTlDOcGmctt5K9254rV0LG8hS9BmDeFBy:h_Ke2J4Z3Ra4WhtQH2i8ra7LSCk=" alt="å›¾ç‰‡1"><br><img src="https://cdn-a.markji.com/files/67fbef0d2d0565736319db78_hd.png?e=1744648123046&amp;token=xX63b9jqTlDOcGmctt5K9254rV0LG8hS9BmDeFBy:EwkA1BCeOR506p02Z6CFZX01NgI=" alt="å›¾ç‰‡1"></li></ul><h3 id="wwwç›®å½•å¤„ç†">wwwç›®å½•å¤„ç†</h3><p>é—®é¢˜ï¼šå†…å®¹æ‹·è´è¿›wwwåæ¶ˆå¤±<br>è§£å†³æ–¹æ¡ˆï¼š</p><ol><li>åˆ›å»ºä¸´æ—¶å®¹å™¨</li><li>æ‹·è´wwwç›®å½•å†…å®¹</li><li>é‡æ–°æŒ‚è½½ï¼ˆç±»ä¼¼config.iniçš„æ“ä½œï¼‰</li></ol><h2 id="æ’­æ”¾å™¨é…ç½®">æ’­æ”¾å™¨é…ç½®</h2><h3 id="VLCæ’­æ”¾å™¨">VLCæ’­æ”¾å™¨</h3><ul><li>ä¸‹è½½å®‰è£…VLC</li><li>å¯ç”¨äºæµ‹è¯•ç‚¹æ’­åŠŸèƒ½<br><img src="https://cdn-a.markji.com/files/67fca36c75151df2bbebfd81_hd.png?e=1744648123046&amp;token=xX63b9jqTlDOcGmctt5K9254rV0LG8hS9BmDeFBy:FXsagarh2L9cEnR6NUc4_u-LMIg=" alt="å›¾ç‰‡1"></li></ul><h2 id="å¾…è§£å†³é—®é¢˜">å¾…è§£å†³é—®é¢˜</h2><h3 id="WebAssistè®¿é—®é—®é¢˜">WebAssistè®¿é—®é—®é¢˜</h3><ul><li>ç›®å‰æ— æ³•è®¿é—®</li><li>å¾…åç»­æ›´æ–°è§£å†³æ–¹æ¡ˆ</li></ul>]]></content>
    
    
    <summary type="html">è®°å½•ä½¿ç”¨ZLMediakitå®ç°ç‚¹æ’­åŠŸèƒ½çš„è¿‡ç¨‹ï¼ŒåŒ…æ‹¬æ–‡ä»¶æŒ‚è½½ã€è·¯å¾„é…ç½®ç­‰é—®é¢˜çš„è§£å†³æ–¹æ¡ˆ</summary>
    
    
    
    <category term="éŸ³è§†é¢‘å¼€å‘" scheme="https://eatbreads.github.io/categories/%E9%9F%B3%E8%A7%86%E9%A2%91%E5%BC%80%E5%8F%91/"/>
    
    
    <category term="æµåª’ä½“" scheme="https://eatbreads.github.io/tags/%E6%B5%81%E5%AA%92%E4%BD%93/"/>
    
    <category term="Docker" scheme="https://eatbreads.github.io/tags/Docker/"/>
    
    <category term="ZLMediakit" scheme="https://eatbreads.github.io/tags/ZLMediakit/"/>
    
  </entry>
  
  <entry>
    <title>ZLMediakitçš„Dockeré…ç½®ä¸ä½¿ç”¨è®°å½•</title>
    <link href="https://eatbreads.github.io/posts/ff5976c9.html"/>
    <id>https://eatbreads.github.io/posts/ff5976c9.html</id>
    <published>2025-04-14T16:03:49.000Z</published>
    <updated>2025-04-14T16:20:13.611Z</updated>
    
    <content type="html"><![CDATA[<h1>ZLMediakité…ç½®è®°å½•</h1><h2 id="åˆå§‹å°è¯•">åˆå§‹å°è¯•</h2><h3 id="vcpkgå®‰è£…">vcpkgå®‰è£…</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vcpkg install zlmediakit</span><br></pre></td></tr></table></figure><p>é…ç½®æ–‡ä»¶ä½ç½®ï¼š</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">~<span class="regexp">/vcpkg/i</span>nstalled<span class="regexp">/x64-linux/</span>tools<span class="regexp">/zlmediakit/</span></span><br></pre></td></tr></table></figure><h2 id="Dockeréƒ¨ç½²">Dockeréƒ¨ç½²</h2><h3 id="é…ç½®æ–‡ä»¶ç®¡ç†æŠ€å·§">é…ç½®æ–‡ä»¶ç®¡ç†æŠ€å·§</h3><ol><li>ä¸´æ—¶è¿è¡Œå®¹å™¨</li><li>ä½¿ç”¨docker cpæ‹·è´é…ç½®æ–‡ä»¶</li><li>åˆ é™¤ä¸´æ—¶å®¹å™¨</li><li>ä¿®æ”¹é…ç½®æ–‡ä»¶</li><li>é‡æ–°æŒ‚è½½è¿è¡Œ</li></ol><h3 id="è¿è¡Œå‘½ä»¤">è¿è¡Œå‘½ä»¤</h3><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">docker run <span class="literal">-d</span> <span class="literal">--name</span> zlmediakit `</span><br><span class="line">  <span class="literal">-p</span> <span class="number">1935</span>:<span class="number">1935</span> `</span><br><span class="line">  <span class="literal">-p</span> <span class="number">8080</span>:<span class="number">80</span> `</span><br><span class="line">  <span class="literal">-p</span> <span class="number">554</span>:<span class="number">554</span> `</span><br><span class="line">  <span class="literal">-p</span> <span class="number">30000</span><span class="literal">-30500</span>:<span class="number">30000</span><span class="literal">-30500</span>/tcp `</span><br><span class="line">  <span class="literal">-p</span> <span class="number">30000</span><span class="literal">-30500</span>:<span class="number">30000</span><span class="literal">-30500</span>/udp `</span><br><span class="line">  <span class="literal">-v</span> C:/Users/<span class="number">18526</span>/Desktop/config/config.ini:/opt/media/conf/config.ini `</span><br><span class="line">  <span class="literal">-v</span> C:/Users/<span class="number">18526</span>/Desktop/www:/opt/media/bin/www `</span><br><span class="line">  zlmediakit/zlmediakit:master</span><br></pre></td></tr></table></figure><p>æ³¨æ„ï¼š</p><ul><li>PowerShellæ¢è¡Œç¬¦æ˜¯`</li><li>wwwéœ€è¦æŒ‚è½½åˆ°binä¸‹</li><li>éœ€è¦å…ˆå¯¼å‡ºwwwç›®å½•å†…å®¹</li></ul><h3 id="é…ç½®çƒ­æ›´æ–°">é…ç½®çƒ­æ›´æ–°</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl <span class="string">&quot;http://å®¿ä¸»æœºIP:8080/api/reloadConfig?secret=your_custom_secret&quot;</span></span><br></pre></td></tr></table></figure><h2 id="æ¨æ‹‰æµæµ‹è¯•">æ¨æ‹‰æµæµ‹è¯•</h2><h3 id="RTSPç‰¹æ€§è¯´æ˜">RTSPç‰¹æ€§è¯´æ˜</h3><p>RTSPæ˜¯å®æ—¶ä¼ è¾“åè®®ï¼Œç±»ä¼¼ç›´æ’­ï¼Œä¸ä¼šæŒä¹…å­˜å‚¨å†…å®¹</p><h3 id="æ¨æµå‘½ä»¤">æ¨æµå‘½ä»¤</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ffmpeg -re -i <span class="string">&quot;dd.mp4&quot;</span> -vcodec h264 -acodec aac -f rtsp -rtsp_transport tcp rtsp://127.0.0.1/live/test</span><br></pre></td></tr></table></figure><h3 id="æ‹‰æµæ–¹å¼">æ‹‰æµæ–¹å¼</h3><ol><li>RTSPæ‹‰æµï¼š</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ffplay -rtsp_transport tcp rtsp://127.0.0.1/live/test</span><br></pre></td></tr></table></figure><ol start="2"><li>HLSæ‹‰æµï¼š</li></ol><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:<span class="regexp">//i</span>p:port<span class="regexp">/live/</span>testxxx/hls.m3u8</span><br></pre></td></tr></table></figure><p>æ³¨æ„ï¼šliveæ˜¯å›ºå®šè·¯å¾„</p><h3 id="è¡¥å……è¯´æ˜">è¡¥å……è¯´æ˜</h3><ul><li>æ”¯æŒRTSPå’ŒRTMPæ··ç”¨</li><li>wwwç›®å½•ç”¨äºå­˜æ”¾èµ„æº</li></ul>]]></content>
    
    
    <summary type="html">è®°å½•ZLMediakitåœ¨Dockerç¯å¢ƒä¸‹çš„é…ç½®è¿‡ç¨‹ï¼ŒåŒ…æ‹¬å®‰è£…ã€é…ç½®æ–‡ä»¶ç®¡ç†å’Œæ¨æ‹‰æµæµ‹è¯•</summary>
    
    
    
    <category term="è¿ç»´ç¬”è®°" scheme="https://eatbreads.github.io/categories/%E8%BF%90%E7%BB%B4%E7%AC%94%E8%AE%B0/"/>
    
    
    <category term="Docker" scheme="https://eatbreads.github.io/tags/Docker/"/>
    
    <category term="ZLMediakit" scheme="https://eatbreads.github.io/tags/ZLMediakit/"/>
    
    <category term="æµåª’ä½“æœåŠ¡å™¨" scheme="https://eatbreads.github.io/tags/%E6%B5%81%E5%AA%92%E4%BD%93%E6%9C%8D%E5%8A%A1%E5%99%A8/"/>
    
  </entry>
  
  <entry>
    <title>OpenGLå¤šçº¿ç¨‹è°ƒè¯•ä¸è§£å†³æ–¹æ¡ˆ</title>
    <link href="https://eatbreads.github.io/posts/31a16705.html"/>
    <id>https://eatbreads.github.io/posts/31a16705.html</id>
    <published>2025-04-14T15:51:18.000Z</published>
    <updated>2025-04-14T16:20:13.614Z</updated>
    
    <content type="html"><![CDATA[<h1>OpenGLå¤šçº¿ç¨‹é—®é¢˜æ’æŸ¥ä¸è§£å†³</h1><p><img src="https://cdn-a.markji.com/files/67fa187575151df2bbad0eb6_hd.png?e=1744648123046&amp;token=xX63b9jqTlDOcGmctt5K9254rV0LG8hS9BmDeFBy:0i0tese83SpqFzkut91oyoxu2oY=" alt="å›¾ç‰‡1"></p><h2 id="åˆå§‹é—®é¢˜">åˆå§‹é—®é¢˜</h2><p>è¿è¡Œæ—¶å‘ç°ä»£ç æŠ¥é”™ï¼ŒåŸå§‹ä»£ç ä¸­æ²¡æœ‰makeCurrentè°ƒç”¨ã€‚æ·»åŠ åå‡ºç°æ–°çš„é”™è¯¯ï¼š<br><img src="https://cdn-a.markji.com/files/67fa222375151df2bbae41e0_hd.png?e=1744648123046&amp;token=xX63b9jqTlDOcGmctt5K9254rV0LG8hS9BmDeFBy:CmWd37aFZHTM0K34RySbz__unW0=" alt="å›¾ç‰‡1"></p><figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Cannot make QOpenGLContext current in a different thread</span><br></pre></td></tr></table></figure><h2 id="é—®é¢˜åˆ†æ">é—®é¢˜åˆ†æ</h2><h3 id="ä»£ç ç»“æ„">ä»£ç ç»“æ„</h3><ul><li>è§£ç çº¿ç¨‹(ReadThread)è¯»å–æ•°æ®</li><li>é€šè¿‡emitå‘é€ä¿¡å·</li><li>Widgetä¸­æ³¨å†Œä¿¡å·ä¸æ§½</li><li>è°ƒç”¨updateImageæ›´æ–°<br><img src="https://cdn-a.markji.com/files/67fa1c6075151df2bbad8810_hd.png?e=1744648123046&amp;token=xX63b9jqTlDOcGmctt5K9254rV0LG8hS9BmDeFBy:yZEMrUwdwFqWtmzq8L18R2kCHzY=" alt="å›¾ç‰‡1"></li></ul><h3 id="è°ƒè¯•æŠ€å·§">è°ƒè¯•æŠ€å·§</h3><ul><li>å•æ­¥è·³è¿‡ï¼šä¸è¿›å…¥å‡½æ•°ä½“ï¼Œç›´æ¥åˆ°ä¸‹ä¸€è¡Œ</li><li>å•æ­¥è¿›å…¥ï¼šè¿›å…¥å‡½æ•°å†…éƒ¨</li><li>å•æ­¥è·³å‡ºï¼šé€€å‡ºå½“å‰å‡½æ•°<br><img src="https://cdn-a.markji.com/files/67fa1f5f75151df2bbadf206_hd.png?e=1744648123046&amp;token=xX63b9jqTlDOcGmctt5K9254rV0LG8hS9BmDeFBy:zGIUUU5ha_omPwSHyFG_IdfC0uc=" alt="å›¾ç‰‡1"></li></ul><h3 id="æ ¹æœ¬åŸå› ">æ ¹æœ¬åŸå› </h3><ul><li>updateImageåœ¨è§£ç çº¿ç¨‹ä¸­è§¦å‘</li><li>OpenGLä¸Šä¸‹æ–‡(Context)åœ¨Qtä¸­åªèƒ½åœ¨åˆ›å»ºçº¿ç¨‹ä¸­æ¿€æ´»(makeCurrent)</li></ul><h2 id="è§£å†³æ–¹æ¡ˆ">è§£å†³æ–¹æ¡ˆ</h2><h3 id="æ–¹æ¡ˆä¸€ï¼šAutoæ¨¡å¼-æ·±æ‹·è´">æ–¹æ¡ˆä¸€ï¼šAutoæ¨¡å¼ + æ·±æ‹·è´</h3><p><img src="https://cdn-a.markji.com/files/67fa233075151df2bbae64da_hd.png?e=1744648123046&amp;token=xX63b9jqTlDOcGmctt5K9254rV0LG8hS9BmDeFBy:-yfpyons9ehsOOcbxmQlFOabt6s=" alt="å›¾ç‰‡1"><br>ä¼˜ç‚¹ï¼š</p><ul><li>å®ç°ç®€å•</li></ul><p>ç¼ºç‚¹ï¼š</p><ul><li>emit(image)é»˜è®¤æµ…æ‹·è´</li><li>å¯èƒ½å¯¼è‡´ä¸»çº¿ç¨‹å’Œè§£ç çº¿ç¨‹è®¿é—®å†²çª</li><li>è§£ç çº¿ç¨‹å¤„ç†é€Ÿåº¦å¿«äºä¸»çº¿ç¨‹æ—¶å¯èƒ½å´©æºƒ</li></ul><p>æ”¹è¿›ï¼š</p><ul><li>åœ¨å‘é€ä¿¡å·æ—¶ä½¿ç”¨image.copy()</li><li>é¿å…ä¿®æ”¹åŒä¸€ä»½image</li></ul><h3 id="æ–¹æ¡ˆäºŒï¼šä½¿ç”¨é˜»å¡æ–¹å¼">æ–¹æ¡ˆäºŒï¼šä½¿ç”¨é˜»å¡æ–¹å¼</h3><p><img src="https://cdn-a.markji.com/files/67fa256275151df2bbaef138_hd.png?e=1744648123046&amp;token=xX63b9jqTlDOcGmctt5K9254rV0LG8hS9BmDeFBy:_x8HnTqg5OPILeNFkR8791dGpy0=" alt="å›¾ç‰‡1"><br>ç‰¹ç‚¹ï¼š</p><ul><li>æ§åˆ¶åŒæ—¶è®¿é—®</li><li>ä¿è¯çº¿ç¨‹å®‰å…¨</li></ul><h2 id="è¡¥å……è¯´æ˜">è¡¥å……è¯´æ˜</h2><p>ä¹‹å‰ä½¿ç”¨QPainteræ²¡é—®é¢˜çš„åŸå› ï¼š</p><ul><li>æ²¡æœ‰OpenGLçš„åŒçº¿ç¨‹è¦æ±‚</li><li>å¯ä»¥ä½¿ç”¨Directæ¨¡å¼</li><li>ä¸éœ€è¦æ‹·è´image(å› ä¸ºåœ¨åŒä¸€çº¿ç¨‹)</li></ul>]]></content>
    
    
    <summary type="html">è®°å½•OpenGLåœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸‹é‡åˆ°çš„é—®é¢˜åŠè§£å†³æ–¹æ¡ˆï¼ŒåŒ…æ‹¬ä¸Šä¸‹æ–‡åˆ‡æ¢ã€çº¿ç¨‹åŒæ­¥ç­‰å†…å®¹</summary>
    
    
    
    <category term="å›¾å½¢ç¼–ç¨‹" scheme="https://eatbreads.github.io/categories/%E5%9B%BE%E5%BD%A2%E7%BC%96%E7%A8%8B/"/>
    
    
    <category term="å¤šçº¿ç¨‹" scheme="https://eatbreads.github.io/tags/%E5%A4%9A%E7%BA%BF%E7%A8%8B/"/>
    
    <category term="Qt" scheme="https://eatbreads.github.io/tags/Qt/"/>
    
    <category term="OpenGL" scheme="https://eatbreads.github.io/tags/OpenGL/"/>
    
    <category term="è°ƒè¯•" scheme="https://eatbreads.github.io/tags/%E8%B0%83%E8%AF%95/"/>
    
  </entry>
  
</feed>
